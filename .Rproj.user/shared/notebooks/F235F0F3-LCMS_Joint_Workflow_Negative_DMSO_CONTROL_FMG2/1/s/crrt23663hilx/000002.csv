"0","lms_plot_tics <- function(tics, rt = NULL, plot_type = ""spec""){"
"0","  min2sec <- 60"
"0","  "
"0","  if (unique(tics$polarity) == 1){"
"0","    polarity <- ""(positive polarity)"""
"0","  } else if (unique(tics$polarity) == 0){"
"0","    polarity <- ""(negative polarity)"""
"0","  }"
"0","  "
"0","  if(is.null(rt)){"
"0","    rt <-  round (base::range(tics$ret_time) /  min2sec)"
"0","  } else{"
"0","    rt <- round(rt)"
"0","  }"
"0","    "
"0","  if(plot_type == ""spec""){"
"0","      if(diff(rt)> 6){"
"0","        tick_values <- seq(from = rt[1], to = rt[2], by = 2)"
"0","      }else if (diff(rt) <= 6 & diff(rt) >= 1){"
"0","        tick_values <- seq(from = rt[1], to = rt[2], by = 1)"
"0","      }else {"
"0","        stop(""Non valid retention time range"")"
"0","      }"
"0","      ggplot(tics) +"
"0","      geom_line(aes(x = ret_time /  min2sec, y = tic, color = treatment, group = file)) +"
"0","      scale_x_continuous(""Retention time (min)"", limits = rt, breaks = tick_values) + "
"0","      scale_y_continuous(""Total Ion Count (a.u.)"") +"
"0","      scale_colour_manual(""Treatment"", values = treatment_col) +"
"0","      ggtitle(paste(""Total Ion Count across all retention times"", polarity))"
"0","  }else if(plot_type == ""boxplot""){"
"0","    tics <- tics %>% filter(ret_time >= rt[1] * min2sec & ret_time <= rt[2]* min2sec)"
"0","    ggplot(tics) + "
"0","    geom_boxplot(aes(x = fileName, y = tic, fill = treatment)) +"
"0","    scale_fill_manual(""Treatment"", values = treatment_col) +"
"0","    scale_y_log10() +"
"0","    theme(axis.text.x = element_text(angle = 45, hjust = 1)) +"
"0","    ggtitle(paste(""Boxplot of the Total Ion Count by sample"", polarity))"
"0","  }"
"0","}"
