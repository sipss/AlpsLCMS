library(NIHSlcms)
library(NIHSlcms)
file_name <-  system.file("extdata", "peakdet.rds", package = "NIHSlcms")
peakdet <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
peakdet_align <- lcms_align_rtime(peakdet, params = preproc_params)
print(peakdet_align)
file_name <-  system.file("extdata", "peakdet.rds", package = "NIHSlcms")
peakdet <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
peakdet_align <- lcms_align_rtime(peakdet, params = preproc_params)
print(peakdet_align)
file_name <-  system.file("extdata", "peakdet.rds", package = "NIHSlcms")
peakdet <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
peakdet_align <- lcms_align_rtime(peakdet, params = preproc_params)
print(peakdet_align)
file_name <-  system.file("extdata", "peakdet.rds", package = "NIHSlcms")
peakdet <- base::readRDS(file_name)
library(NIHSlcms)
file_name <-  system.file("extdata", "peakdet.rds", package = "NIHSlcms")
peakdet <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
peakdet_align <- lcms_align_rtime(peakdet, params = preproc_params)
View(peakdet)
file_name <-  system.file("extdata", "peakdet.rds", package = "NIHSlcms")
peakdet <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
params <-preproc_params
obiwarp_params <- base::suppressWarnings(
base::suppressMessages(
quiet(xcms::ObiwarpParam(binSize = params$profStep,
centerSample = params$centerSample,
response = params$response,
distFun = params$distFun,
gapInit = params$gapInit,
gapExtend = params$gapExtend,
factorDiag = params$factorDiag,
factorGap = params$factorGap,
localAlignment = params$localAlignment,
initPenalty = params$initPenalty))
)
)
peakdet_align <-  base::suppressWarnings(
base::suppressMessages(
quiet(xcms::adjustRtime(peakdet, param = obiwarp_params))
)
)
quiet <- function(x) {
base::sink(base::tempfile())
base::on.exit(base::sink())
base::invisible(base::force(x))
}
cat("\n","Aligning the peak table using the optimized set of parameters obtained from IPO package.","\n")
obiwarp_params <- base::suppressWarnings(
base::suppressMessages(
quiet(xcms::ObiwarpParam(binSize = params$profStep,
centerSample = params$centerSample,
response = params$response,
distFun = params$distFun,
gapInit = params$gapInit,
gapExtend = params$gapExtend,
factorDiag = params$factorDiag,
factorGap = params$factorGap,
localAlignment = params$localAlignment,
initPenalty = params$initPenalty))
)
)
peakdet_align <-  base::suppressWarnings(
base::suppressMessages(
quiet(xcms::adjustRtime(peakdet, param = obiwarp_params))
)
)
library(NIHSlcms)
file_name <-  system.file("extdata", "peakdet.rds", package = "NIHSlcms")
peakdet <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
peakdet_align <- lcms_align_rtime(peakdet, params = preproc_params)
print(peakdet_align)
peakdet@processingData@files
peakdet@processingData@processing
peakdet@featureData@data
file_path <- system.file("extdata", "rearrange_mait", package = "NIHSlcms")
samples_mzxml <- list.files(file_path, recursive = TRUE, full.names = TRUE)
meta_path <- system.file("extdata", "metadata.xlsx", package = "NIHSlcms")
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
dataset <- suppressWarnings(lcms_read_samples(samples_mzxml, mode = "onDisk"))
metadata <- lcms_meta_read(meta_path)
dataset_meta <- lcms_meta_add(dataset, metadata, by = "sampleNames")
peakdet <- lcms_find_chrom_peaks_cwp(dataset_meta, params = preproc_params)
print(peakdet)
saveRDS(peakdet,"peakdet.rds")
library(NIHSlcms)
file_name <-  system.file("extdata", "peakdet.rds", package = "NIHSlcms")
peakdet <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
peakdet_align <- lcms_align_rtime(peakdet, params = preproc_params)
library(NIHSlcms)
file_name <-  system.file("extdata", "peakdet.rds", package = "NIHSlcms")
peakdet <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
peakdet_align <- lcms_align_rtime(peakdet, params = preproc_params)
opt_path <-  system.file("extdata","ipo_opt", package = "NIHSlcms")
View(peakdet_align)
opt_path <-  system.file("extdata","ipo_opt", package = "NIHSlcms")
opt_path <-  system.file("extdata","ipo_opt", package = "NIHSlcms")
file_name <- system.file("extdata", "dataset_pos_rt_rs.rds", package = "NIHSlcms")
dataset <- lcms_dataset_load(file_name)
library(NIHSlcms)
library(NIHSlcms)
opt_path <-  system.file("extdata","ipo_opt", package = "NIHSlcms")
file_name <- system.file("extdata", "dataset_pos_rt_rs.rds", package = "NIHSlcms")
dataset <- lcms_dataset_load(file_name)
default_peakpicking_params <- lcms_default_peakpicking_params(optimize = TRUE)
resultPeakpicking <- lcms_peakpicking_optimization(dataset,
default_peakpicking_params,
opt_path = opt_path,
subdir = NULL)
library(NIHSlcms)
opt_path <- "C:/Users/Biosignal/Desktop/LCMS_2019/NIHSlcms/inst/extdata/ipo_opt"
file_name <- system.file("extdata", "dataset_pos_rt_rs.rds", package = "NIHSlcms")
dataset <- lcms_dataset_load(file_name)
default_peakpicking_params <- lcms_default_peakpicking_params(optimize = TRUE)
resultPeakpicking <- lcms_peakpicking_optimization(dataset,
default_peakpicking_params,
opt_path = opt_path,
subdir = NULL)
opt_path <- "C:/Users/Biosignal/Desktop/LCMS_2019/NIHSlcms/inst/extdata/ipo_opt"
base::dir.create(opt_path)
file_name <- system.file("extdata", "dataset_pos_rt_rs.rds", package = "NIHSlcms")
dataset <- lcms_dataset_load(file_name)
resultPeakpicking <- lcms_peakpicking_optimization(dataset,
default_peakpicking_params,
opt_path = opt_path,
subdir = NULL)
default_peakpicking_params <- lcms_default_peakpicking_params(optimize = TRUE)
resultPeakpicking <- lcms_peakpicking_optimization(dataset,
default_peakpicking_params,
opt_path = opt_path,
subdir = NULL)
library(NIHSlcms)
library(NIHSlcms)
library(NIHSlcms)
library(NIHSlcms)
library(pkgdown)
build_site()
getwd()
library(NIHSlcms)
opt_path <- tempdir()
file_name <- system.file("extdata", "dataset_pos_rt_rs.rds", package = "NIHSlcms")
dataset <- lcms_dataset_load(file_name)
default_peakpicking_params <- lcms_default_peakpicking_params(optimize = TRUE)
resultPeakpicking <- lcms_peakpicking_optimization(dataset,
default_peakpicking_params,
opt_path = opt_path,
subdir = NULL)
saveRDS(resultPeakpicking,"resultPeakpicking.rds2)
)
saveRDS(resultPeakpicking,"resultPeakpicking.rds")
saveRDS(resultPeakpicking,"resultPeakpicking.rds")
library(NIHSlcms)
file_name_pp <- system.file("extdata", "resultPeakpicking.rds", package = "NIHSlcms")
optimizedXcmsSetObject <-base::readRDS(file_name_pp)$best_settings$xset
file_name_rcg <- system.file("extdata", "default_retcorgroup_params.rds", package = "NIHSlcms")
default_retcorgroup_params <- base::readRDS(file_name_rcg)
opt_path <-  system.file("extdata", package = "NIHSlcms")
resultRetcorGroup <- lcms_retcorgroup_optimization(optimizedXcmsSetObject,
default_retcorgroup_params,
opt_path = opt_path,
subdir = NULL)
file_name_pp <- system.file("extdata", "resultPeakpicking.rds", package = "NIHSlcms")
optimizedXcmsSetObject <-base::readRDS(file_name_pp)$best_settings$xset
file_name_rcg <- system.file("extdata", "default_retcorgroup_params.rds", package = "NIHSlcms")
default_retcorgroup_params <- base::readRDS(file_name_rcg)
opt_path <-  system.file("extdata", package = "NIHSlcms")
resultRetcorGroup <- lcms_retcorgroup_optimization(optimizedXcmsSetObject,
default_retcorgroup_params,
opt_path = opt_path,
subdir = NULL)
library(NIHSlcms)
opt_path <- system.file("extdata", "ipo_opt", package = "NIHSlcms")
file_name <- system.file("extdata", "dataset_pos_rt_rs.rds", package = "NIHSlcms")
dataset <- lcms_dataset_load(file_name)
default_peakpicking_params <- lcms_default_peakpicking_params(optimize = TRUE)
resultPeakpicking <- lcms_peakpicking_optimization(dataset,
default_peakpicking_params,
opt_path = opt_path,
subdir = NULL)
library(NIHSlcms)
opt_path <- system.file("extdata", "ipo_opt", package = "NIHSlcms")
file_name <- system.file("extdata", "dataset_pos_rt_rs.rds", package = "NIHSlcms")
dataset <- lcms_dataset_load(file_name)
default_peakpicking_params <- lcms_default_peakpicking_params(optimize = TRUE)
result_peakpicking <- lcms_peakpicking_optimization(dataset,
default_peakpicking_params,
opt_path = opt_path,
subdir = NULL)
saveRDS(result_peakpicking,"result_peakpicking.rds")
library(NIHSlcms)
file_name_pp <- system.file("extdata", "result_peakpicking.rds", package = "NIHSlcms")
optimizedXcmsSetObject <-base::readRDS(file_name_pp)$best_settings$xset
file_name_rcg <- system.file("extdata", "default_retcorgroup_params.rds", package = "NIHSlcms")
default_retcorgroup_params <- base::readRDS(file_name_rcg)
opt_path <-  system.file("extdata", package = "NIHSlcms")
result_retcorgroup <- lcms_retcorgroup_optimization(optimizedXcmsSetObject,
default_retcorgroup_params,
opt_path = opt_path,
subdir = NULL)
saveRDS(result_retcorgroup, "result_retcorgroup.rds")
library(NIHSlcms)
opt_result_path <-system.file("extdata", "ipo_opt", package = "NIHSlcms")
file_name_pp <- system.file("extdata", "result_peakpicking.rds", package = "NIHSlcms")
file_name_rcg <- system.file("extdata", "result_retcorgroup.rds", package = "NIHSlcms")
result_peakpicking <- base::readRDS(file_name_pp)
result_retcor_group <- base::readRDS(file_name_rcg)
lcms_write_opt_params(resultPeakpicking, resultRetcorGroup, opt_result_path)
library(NIHSlcms)
opt_result_path <-system.file("extdata", "ipo_opt", package = "NIHSlcms")
file_name_pp <- system.file("extdata", "result_peakpicking.rds", package = "NIHSlcms")
file_name_rcg <- system.file("extdata", "result_retcorgroup.rds", package = "NIHSlcms")
result_peakpicking <- base::readRDS(file_name_pp)
result_retcor_group <- base::readRDS(file_name_rcg)
lcms_write_opt_params(result_peakpicking, result_retcorgroup, opt_result_path)
library(NIHSlcms)
opt_result_path <-system.file("extdata", "ipo_opt", package = "NIHSlcms")
file_name_pp <- system.file("extdata", "result_peakpicking.rds", package = "NIHSlcms")
file_name_rcg <- system.file("extdata", "result_retcorgroup.rds", package = "NIHSlcms")
result_peakpicking <- base::readRDS(file_name_pp)
result_retcorgroup <- base::readRDS(file_name_rcg)
lcms_write_opt_params(result_peakpicking, result_retcorgroup, opt_result_path)
library(NIHSlcms)
opt_result_path <-system.file("extdata", "ipo_opt", package = "NIHSlcms")
file_name_pp <- system.file("extdata", "result_peakpicking.rds", package = "NIHSlcms")
file_name_rcg <- system.file("extdata", "result_retcorgroup.rds", package = "NIHSlcms")
result_peakpicking <- base::readRDS(file_name_pp)
result_retcorgroup <- base::readRDS(file_name_rcg)
lcms_write_opt_params(result_peakpicking, result_retcorgroup, opt_result_path)
library(NIHSlcms)
library(NIHSlcms)
opt_result_path <-  system.file("extdata","ipo_opt", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
print(preproc_params)
saveRDS(preproc_params,"preproc_params.rds")
library(NIHSlcms)
library(NIHSlcms)
file_path <- system.file("extdata", "rearrange_mait", package = "NIHSlcms")
samples_mzxml <- list.files(file_path, recursive = TRUE, full.names = TRUE)
meta_path <- system.file("extdata", "metadata.xlsx", package = "NIHSlcms")
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
dataset <- suppressWarnings(lcms_read_samples(samples_mzxml, mode = "onDisk"))
metadata <- lcms_meta_read(meta_path)
dataset_meta <- lcms_meta_add(dataset, metadata, by = "sampleNames")
peakdet <- lcms_find_chrom_peaks_cwp(dataset_meta, params = preproc_params)
print(peakdet)
saveRDS(peakdet,"peakdet.rds")
library(NIHSlcms)
library(NIHSlcms)
file_name <-  system.file("extdata", "peakdet.rds", package = "NIHSlcms")
peakdet <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
peakdet_align <- lcms_align_rtime(peakdet, params = preproc_params)
print(peakdet_align)
file_name <-  system.file("extdata", "peakdet.rds", package = "NIHSlcms")
peakdet <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
peakdet_align <- lcms_align_rtime(peakdet, params = preproc_params)
peakdet_align <- lcms_align_rtime(peakdet, params = preproc_params)
library(NIHSlcms)
library(NIHSlcms)
nfile_name <-  system.file("extdata", "peakdet.rds", package = "NIHSlcms")
peakdet <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
peakdet_align <- lcms_align_rtime(peakdet, params = preproc_params)
print(peakdet_align)
file_name <-  system.file("extdata", "peakdet.rds", package = "NIHSlcms")
peakdet <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
file_name <-  system.file("extdata", "peakdet.rds", package = "NIHSlcms")
peakdet <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
peakdet_align <- lcms_align_rtime(peakdet, params = preproc_params)
print(peakdet_align)
library(NIHSlcms)
file_name <-  system.file("extdata", "peakdet_align.rds", package = "NIHSlcms")
peakdet_align <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
peak_table <- lcms_group_peaks(peakdet_align, params = preproc_params)
print(peak_table
)
saveRDS(peak_table,"peak_table.rds")
library(NIHSlcms)
library(NIHSlcms)
library(NIHSlcms)
file_name <-  system.file("extdata", "peakdet_align.rds", package = "NIHSlcms")
data <- base::readRDS(file_name)
rta_plot <- lcms_retention_time_alignment_plot(data)
print(rta_plot)
library(NIHSlcms)
file_name <-  system.file("extdata", "peakdet_align.rds", package = "NIHSlcms")
dataset <- base::readRDS(file_name)
chr_peak_image <- lmcs_plot_chrom_peak_image(dataset, binSize = 5, xlim = NULL, log = FALSE,
xlab = "retention time (min)", yaxt = par("yaxt"))
title(main ="Detected Peaks (Aligned)"
)
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
peak_table_imputed <- lcms_fill_chrom_peaks(peak_table)
print(peak_table_imputed)
saveRDS(peak_table_imputed,"peak_table_imputed")
library(NIHSlcms)
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_imputed.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
data_dir <-  system.file("extdata", "rearrange_mait", package = "NIHSlcms")
project_dir <-  system.file("extdata", package = "NIHSlcms")
project <- "project"
peak_table_mait <- lcms_to_mait(data_dir = data_dir,
project_dir = project_dir,
project = project,
preproc_params = preproc_params,
peak_table = peak_table)
print(peak_table_mait)
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_imputed.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
data_dir <-  system.file("extdata", "rearrange_mait", package = "NIHSlcms")
project_dir <-  system.file("extdata", package = "NIHSlcms")
project <- "project"
peak_table_mait <- lcms_to_mait(data_dir = data_dir,
project_dir = project_dir,
project = project,
preproc_params = preproc_params,
peak_table = peak_table)
print(peak_table_mait)
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_imputed.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
data_dir <-  system.file("extdata", "rearrange_mait", package = "NIHSlcms")
project_dir <-  system.file("extdata", package = "NIHSlcms")
project <- "project"
peak_table_mait <- lcms_to_mait(data_dir = data_dir,
project_dir = project_dir,
project = project,
preproc_params = preproc_params,
peak_table = peak_table)
print(peak_table_mait)
saveRDS(peak_table_mait,"peak_table_mait.rds")
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_imputed.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
data_dir <-  system.file("extdata", "rearrange_mait", package = "NIHSlcms")
project_dir <-  system.file("extdata", package = "NIHSlcms")
project <- "project"
peak_table_mait <- lcms_to_mait(data_dir = data_dir,
project_dir = project_dir,
project = project,
preproc_params = preproc_params,
peak_table = peak_table)
print(peak_table_mait)
file_name <-  system.file("extdata", "peak_table_imputed.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
data_dir <-  system.file("extdata", "rearrange_mait", package = "NIHSlcms")
project_dir <-  system.file("extdata", package = "NIHSlcms")
project <- "project"
file_name <-  system.file("extdata", "peak_table_imputed.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
data_dir <-  system.file("extdata", "rearrange_mait", package = "NIHSlcms")
project_dir <-  system.file("extdata", package = "NIHSlcms")
project <- "project"
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_imputed.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
data_dir <-  system.file("extdata", "rearrange_mait", package = "NIHSlcms")
project_dir <-  system.file("extdata", package = "NIHSlcms")
project <- "project"
peak_table_mait <- lcms_to_mait(data_dir = data_dir,
project_dir = project_dir,
project = project,
preproc_params = preproc_params,
peak_table = peak_table)
print(peak_table_mait)
saveRDS(peak_table_mait,"peak_table_mait.rds")
library(NIHSlcms)
library(NIHSlcms)
data_dir <-  system.file("extdata", "rearrange_mait", package = "NIHSlcms")
mait_params_path <- system.file("extdata", "results_project", package = "NIHSlcms")
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
parameters <- c(dataDir = data_dir, preproc_params)
quiet <- function(x) {
base::sink(base::tempfile())
base::on.exit(base::sink())
base::invisible(base::force(x))}
quiet(getClassDef("MAIT","MAIT"))
MAIT.object = signature(MAIT.Object = "MAIT")
MAIT.object <- methods::new("MAIT")
MAIT.object@RawData@parameters@sampleProcessing <- parameters
lcms_write_parameter_table(MAIT::parameters(MAIT.object), folder = mait_params_path)
library(NIHSlcms)
library(NIHSlcms)
library(NIHSlcms)
file_name <-  system.file("extdata","peak_table_mait.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
peak_table_ann <- lcms_peak_annotation(MAIT.object = peak_table)
lcms_raw_data(peak_table_ann)
saveRDS(peak_table_ann,"peak_table_ann.rds")
library(NIHSlcms)
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_mait.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
peak_table_ann <- peak_annotation(MAIT.object = peak_table)
lcms_raw_data(peak_table)
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_mait.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
peak_table_ann <- lcms_peak_annotation(MAIT.object = peak_table)
lcms_raw_data(peak_table)
file_name <-  system.file("extdata", "peak_table_mait.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
peak_table_ann <- lcms_peak_annotation(MAIT.object = peak_table)
lcms_raw_data(peak_table_ann)
lcms_raw_data(peak_table_ann):
lcms_raw_data(peak_table_ann)
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_mait.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
peak_table_ann <- lcms_peak_annotation(MAIT.object = peak_table)
lcms_raw_data(peak_table)
file_name <-  system.file("extdata","peak_table_mait.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
peak_table_ann <- lcms_peak_annotation(MAIT.object = peak_table)
lcms_raw_data(peak_table_ann)
file_name <-  system.file("extdata", "peak_table_mait.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
peak_table_ann <- lcms_peak_annotation(MAIT.object = peak_table)
lcms_raw_data(peak_table_ann)
library(NIHSlcms)
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_ann.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
#peak_table@PhenoData@classes <- c("plasma","plasma..ringer...palm")
peak_table_sig_ann <- lcms_spectral_sig_features(MAIT.object = peak_table,
pvalue=0.05,
p.adj="none",
scale=FALSE)
print(peak_table_sig_ann)
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_ann.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
#peak_table@PhenoData@classes <- c("plasma","plasma..ringer...palm")
peak_table_sig_ann <- lcms_spectral_sig_features(MAIT.object = peak_table,
pvalue=0.05,
p.adj="none",
scale=FALSE)
print(peak_table_sig_ann)
saveRDS(peak_table_sig_ann,"peak_table_sig_ann.rds")
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_ann.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
peak_table_sig_ann <- lcms_spectral_sig_features(MAIT.object = peak_table,
pvalue=0.05,
p.adj="none",
scale=FALSE)
print(peak_table_sig_ann)
library(NIHSlcms)
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_sig_ann.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
sig_table <- lcms_sig_peaks_table(peak_table,  printCSVfile=FALSE)
str(sig_table)
saveRDS(sig_table,"sig_table.rds")
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_sig_ann.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
sig_table <- lcms_sig_peaks_table(peak_table,  printCSVfile=FALSE)
str(sig_table)
library(NIHSlcms)
file_name <- system.file("extdata", "peak_table_sig_ann.rds", package = "NIHSlcms")
peak_table <- readRDS(file_name)
metabololite_table <- lcms_identify_metabolites(MAIT.object = peak_table,
peakTolerance = 0.005)
