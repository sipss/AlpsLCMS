lcms_dataset <- suppressWarnings(lcms_read_samples(samples_mzxml, mode = "onDisk"))
print(lcms_dataset)
rtime_range = c(4,8)
lcms_dataset <- lcms_filterRTmin(lcms_dataset, rt = rtime_range)
print(lcms_dataset_pos)
#read samples
file_path <- system.file("extdata", package = "NIHSlcms")
rawconverter <- NULL
file_format <- "mzXML"
samples_mzxml <- lcms_list_mzxml_samples(file_path,
file_format = file_format,
rawconverter = rawconverter)
samples_mzxml <- as.character(samples_mzxml)
lcms_dataset <- suppressWarnings(lcms_read_samples(samples_mzxml, mode = "onDisk"))
print(lcms_dataset)
#filter retention time
rtime_range = c(4,8)
lcms_dataset <- lcms_filterRTmin(lcms_dataset, rt = rtime_range)
print(lcms_dataset)
#read samples
file_path <- system.file("extdata", package = "NIHSlcms")
rawconverter <- NULL
file_format <- "mzXML"
samples_mzxml <- lcms_list_mzxml_samples(file_path,
file_format = file_format,
rawconverter = rawconverter)
samples_mzxml <- as.character(samples_mzxml)
lcms_dataset <- suppressWarnings(lcms_read_samples(samples_mzxml, mode = "onDisk"))
print(lcms_dataset)
#filter retention time
rtime_range = c(4,8)
lcms_dataset <- lcms_filterRTmin(lcms_dataset, rt = rtime_range)
print(lcms_dataset)
lcms_dataset@phenoData
lcms_dataset@experimentData
lcms_dataset@featureData
lcms_dataset@featureData@varMetadata
lcms_dataset@featureData@data
#read samples
file_path <- system.file("extdata", package = "NIHSlcms")
rawconverter <- NULL
file_format <- "mzXML"
samples_mzxml <- lcms_list_mzxml_samples(file_path,
file_format = file_format,
rawconverter = rawconverter)
samples_mzxml <- as.character(samples_mzxml)
lcms_dataset <- suppressWarnings(lcms_read_samples(samples_mzxml, mode = "onDisk"))
metadata <- lcms_meta_read(system.file("extdata",
"metadata.xlsx",
package = "NIHSlcms"))
lcms_dataset <- lcms_meta_add(lcms_dataset,
metadata,
by = "sampleNames")
#filter retention time
rtime_range = c(4,8)
lcms_dataset <- lcms_filterRTmin(lcms_dataset, rt = rtime_range)
print(lcms_dataset)
#read samples
file_path <- system.file("extdata", package = "NIHSlcms")
rawconverter <- NULL
file_format <- "mzXML"
samples_mzxml <- lcms_list_mzxml_samples(file_path,
file_format = file_format,
rawconverter = rawconverter)
samples_mzxml <- as.character(samples_mzxml)
lcms_dataset <- suppressWarnings(lcms_read_samples(samples_mzxml, mode = "onDisk"))
metadata <- lcms_meta_read(system.file("extdata",
"metadata.xlsx",
package = "NIHSlcms"))
lcms_dataset <- lcms_meta_add(lcms_dataset,
metadata,
by = "sampleNames")
#filter retention time
rtime_range = c(4,8)
lcms_dataset <- lcms_filterRTmin(lcms_dataset, rt = rtime_range)
print(lcms_dataset)
#read samples
file_path <- system.file("extdata", package = "NIHSlcms")
rawconverter <- NULL
file_format <- "mzXML"
samples_mzxml <- lcms_list_mzxml_samples(file_path,
file_format = file_format,
rawconverter = rawconverter)
samples_mzxml <- as.character(samples_mzxml)
lcms_dataset <- suppressWarnings(lcms_read_samples(samples_mzxml, mode = "onDisk"))
metadata <- lcms_meta_read(system.file("extdata",
"metadata.xlsx",
package = "NIHSlcms"))
lcms_dataset <- lcms_meta_add(lcms_dataset,
metadata,
by = "sampleNames")
#filter retention time
rtime_range = c(4,8)
lcms_dataset <- lcms_filterRTmin(lcms_dataset, rt = rtime_range)
print(lcms_dataset)
no_blank_files <- Biobase::pData(lcms_dataset)$sampleNames
no_blank_files_treatment <- Biobase::pData(lcms_dataset)$treatment
filetreat_info <- data.frame(Filename = no_blank_files,
Treatment= no_blank_files_treatment,
stringsAsFactors = FALSE)
filetreat_info <- filetreat_info %>% dplyr::group_by(Treatment) %>% dplyr::arrange(Treatment)
filetreat_info <- split(filetreat_info, filetreat_info$Treatment)
drop_treatment <-function(x) {
x$Treatment <- NULL
colnames(x) <- "FileName"
x
}
filetreat_info <- lapply(filetreat_info, FUN = drop_treatment)
for (i in seq_along(filetreat_info)){
filer <- filetreat_info[[i]][["FileName"]]
foldname <-names(filetreat_info)[i]
treatDir <- "C:/Users/Biosignal/Desktop/mzxl_files"
if (length(dir(treatDir)) > 0) {
cat("There are already directories / files in the folder. Not saving new ones.")
cat("\n")
return()
}else{
dir.create(treatDir)
data_subset <- lcms_dataset %>% MSnbase::filterFile(file = filer)
mzR::writeMSData(data_subset,
file = unlist(lapply(treatDir, FUN = paste0, filer)),
outformat = c("mzxml"), copy = FALSE)
}
}
#read samples
file_path <- system.file("extdata", package = "NIHSlcms")
rawconverter <- NULL
file_format <- "mzXML"
samples_mzxml <- lcms_list_mzxml_samples(file_path,
file_format = file_format,
rawconverter = rawconverter)
samples_mzxml <- as.character(samples_mzxml)
lcms_dataset <- suppressWarnings(lcms_read_samples(samples_mzxml, mode = "onDisk"))
metadata <- lcms_meta_read(system.file("extdata",
"metadata.xlsx",
package = "NIHSlcms"))
lcms_dataset <- lcms_meta_add(lcms_dataset,
metadata,
by = "sampleNames")
#filter retention time
rtime_range = c(4,8)
lcms_dataset <- lcms_filterRTmin(lcms_dataset, rt = rtime_range)
print(lcms_dataset)
no_blank_files <- Biobase::pData(lcms_dataset)$sampleNames
no_blank_files_treatment <- Biobase::pData(lcms_dataset)$treatment
filetreat_info <- data.frame(Filename = no_blank_files,
Treatment= no_blank_files_treatment,
stringsAsFactors = FALSE)
filetreat_info <- filetreat_info %>% dplyr::group_by(Treatment) %>% dplyr::arrange(Treatment)
filetreat_info <- split(filetreat_info, filetreat_info$Treatment)
drop_treatment <-function(x) {
x$Treatment <- NULL
colnames(x) <- "FileName"
x
}
filetreat_info <- lapply(filetreat_info, FUN = drop_treatment)
for (i in seq_along(filetreat_info)){
filer <- filetreat_info[[i]][["FileName"]]
foldname <-names(filetreat_info)[i]
treatDir <- "C:/Users/Biosignal/Desktop/mzxl_files"
if (length(dir(treatDir)) > 0) {
cat("There are already directories / files in the folder. Not saving new ones.")
cat("\n")
return()
}else{
dir.create(treatDir)
data_subset <- lcms_dataset %>% MSnbase::filterFile(file = filer)
mzR::writeMSData(data_subset,
file = unlist(lapply(treatDir, FUN = paste0, filer)),
outformat = c("mzxml"), copy = FALSE)
}
}
#read samples
file_path <- system.file("extdata", package = "NIHSlcms")
rawconverter <- NULL
file_format <- "mzXML"
samples_mzxml <- lcms_list_mzxml_samples(file_path,
file_format = file_format,
rawconverter = rawconverter)
samples_mzxml <- as.character(samples_mzxml)
lcms_dataset <- suppressWarnings(lcms_read_samples(samples_mzxml, mode = "onDisk"))
metadata <- lcms_meta_read(system.file("extdata",
"metadata.xlsx",
package = "NIHSlcms"))
lcms_dataset <- lcms_meta_add(lcms_dataset,
metadata,
by = "sampleNames")
#filter retention time
rtime_range = c(4,8)
lcms_dataset <- lcms_filterRTmin(lcms_dataset, rt = rtime_range)
print(lcms_dataset)
no_blank_files <- Biobase::pData(lcms_dataset)$sampleNames
no_blank_files_treatment <- Biobase::pData(lcms_dataset)$treatment
filetreat_info <- data.frame(Filename = no_blank_files,
Treatment= no_blank_files_treatment,
stringsAsFactors = FALSE)
filetreat_info <- filetreat_info %>% dplyr::group_by(Treatment) %>% dplyr::arrange(Treatment)
filetreat_info <- split(filetreat_info, filetreat_info$Treatment)
drop_treatment <-function(x) {
x$Treatment <- NULL
colnames(x) <- "FileName"
x
}
filetreat_info <- lapply(filetreat_info, FUN = drop_treatment)
for (i in seq_along(filetreat_info)){
filer <- filetreat_info[[i]][["FileName"]]
foldname <-names(filetreat_info)[i]
treatDir <- "C:/Users/Biosignal/Desktop/mzxl_files/"
if (length(dir(treatDir)) > 0) {
cat("There are already directories / files in the folder. Not saving new ones.")
cat("\n")
return()
}else{
dir.create(treatDir)
data_subset <- lcms_dataset %>% MSnbase::filterFile(file = filer)
mzR::writeMSData(data_subset,
file = unlist(lapply(treatDir, FUN = paste0, filer)),
outformat = c("mzxml"), copy = FALSE)
}
}
#read samples
file_path <- system.file("extdata", package = "NIHSlcms")
rawconverter <- NULL
file_format <- "mzXML"
samples_mzxml <- lcms_list_mzxml_samples(file_path,
file_format = file_format,
rawconverter = rawconverter)
samples_mzxml <- as.character(samples_mzxml)
lcms_dataset <- suppressWarnings(lcms_read_samples(samples_mzxml, mode = "onDisk"))
metadata <- lcms_meta_read(system.file("extdata",
"metadata.xlsx",
package = "NIHSlcms"))
lcms_dataset <- lcms_meta_add(lcms_dataset,
metadata,
by = "sampleNames")
#filter retention time
rtime_range = c(4,8)
lcms_dataset <- lcms_filterRTmin(lcms_dataset, rt = rtime_range)
print(lcms_dataset)
no_blank_files <- Biobase::pData(lcms_dataset)$sampleNames
no_blank_files_treatment <- Biobase::pData(lcms_dataset)$treatment
filetreat_info <- data.frame(Filename = no_blank_files,
Treatment= no_blank_files_treatment,
stringsAsFactors = FALSE)
filetreat_info <- filetreat_info %>% dplyr::group_by(Treatment) %>% dplyr::arrange(Treatment)
filetreat_info <- split(filetreat_info, filetreat_info$Treatment)
drop_treatment <-function(x) {
x$Treatment <- NULL
colnames(x) <- "FileName"
x
filetreat_info <- lapply(filetreat_info, FUN = drop_treatment)
#read samples
file_path <- system.file("extdata", package = "NIHSlcms")
rawconverter <- NULL
file_format <- "mzXML"
samples_mzxml <- lcms_list_mzxml_samples(file_path,
file_format = file_format,
rawconverter = rawconverter)
samples_mzxml <- as.character(samples_mzxml)
lcms_dataset <- suppressWarnings(lcms_read_samples(samples_mzxml, mode = "onDisk"))
metadata <- lcms_meta_read(system.file("extdata",
"metadata.xlsx",
package = "NIHSlcms"))
lcms_dataset <- lcms_meta_add(lcms_dataset,
metadata,
by = "sampleNames")
#filter retention time
rtime_range = c(4,8)
lcms_dataset <- lcms_filterRTmin(lcms_dataset, rt = rtime_range)
print(lcms_dataset)
no_blank_files <- Biobase::pData(lcms_dataset)$sampleNames
no_blank_files_treatment <- Biobase::pData(lcms_dataset)$treatment
filetreat_info <- data.frame(Filename = no_blank_files,
Treatment= no_blank_files_treatment,
stringsAsFactors = FALSE)
filetreat_info <- filetreat_info %>% dplyr::group_by(Treatment) %>% dplyr::arrange(Treatment)
filetreat_info <- split(filetreat_info, filetreat_info$Treatment)
drop_treatment <-function(x) {
x$Treatment <- NULL
colnames(x) <- "FileName"
x
}
filetreat_info <- lapply(filetreat_info, FUN = drop_treatment)
#read samples
file_path <- system.file("extdata", package = "NIHSlcms")
rawconverter <- NULL
file_format <- "mzXML"
samples_mzxml <- lcms_list_mzxml_samples(file_path,
file_format = file_format,
rawconverter = rawconverter)
samples_mzxml <- as.character(samples_mzxml)
lcms_dataset <- suppressWarnings(lcms_read_samples(samples_mzxml, mode = "onDisk"))
metadata <- lcms_meta_read(system.file("extdata",
"metadata.xlsx",
package = "NIHSlcms"))
lcms_dataset <- lcms_meta_add(lcms_dataset,
metadata,
by = "sampleNames")
#filter retention time
rtime_range = c(4,8)
lcms_dataset <- lcms_filterRTmin(lcms_dataset, rt = rtime_range)
print(lcms_dataset)
no_blank_files <- Biobase::pData(lcms_dataset)$sampleNames
no_blank_files_treatment <- Biobase::pData(lcms_dataset)$treatment
filetreat_info <- data.frame(Filename = no_blank_files,
Treatment= no_blank_files_treatment,
stringsAsFactors = FALSE)
filetreat_info <- filetreat_info %>% dplyr::group_by(Treatment) %>% dplyr::arrange(Treatment)
filetreat_info <- split(filetreat_info, filetreat_info$Treatment)
drop_treatment <-function(x) {
x$Treatment <- NULL
colnames(x) <- "FileName"
x
}
filetreat_info <- lapply(filetreat_info, FUN = drop_treatment)
for (i in seq_along(filetreat_info)){
filer <- filetreat_info[[i]][["FileName"]]
print(filer)
}
#read samples
file_path <- system.file("extdata", package = "NIHSlcms")
rawconverter <- NULL
file_format <- "mzXML"
samples_mzxml <- lcms_list_mzxml_samples(file_path,
file_format = file_format,
rawconverter = rawconverter)
samples_mzxml <- as.character(samples_mzxml)
lcms_dataset <- suppressWarnings(lcms_read_samples(samples_mzxml, mode = "onDisk"))
metadata <- lcms_meta_read(system.file("extdata",
"metadata.xlsx",
package = "NIHSlcms"))
lcms_dataset <- lcms_meta_add(lcms_dataset,
metadata,
by = "sampleNames")
#filter retention time
rtime_range = c(4,8)
lcms_dataset <- lcms_filterRTmin(lcms_dataset, rt = rtime_range)
print(lcms_dataset)
no_blank_files <- Biobase::pData(lcms_dataset)$sampleNames
no_blank_files_treatment <- Biobase::pData(lcms_dataset)$treatment
filetreat_info <- data.frame(Filename = no_blank_files,
Treatment= no_blank_files_treatment,
stringsAsFactors = FALSE)
filetreat_info <- filetreat_info %>% dplyr::group_by(Treatment) %>% dplyr::arrange(Treatment)
filetreat_info <- split(filetreat_info, filetreat_info$Treatment)
drop_treatment <-function(x) {
x$Treatment <- NULL
colnames(x) <- "FileName"
x
}
filetreat_info <- lapply(filetreat_info, FUN = drop_treatment)
for (i in seq_along(filetreat_info)){
filer <- filetreat_info[[i]][["FileName"]]
foldname <-names(filetreat_info)[i]
treatDir <- "C:/Users/Biosignal/Desktop/mzxl_files/"
if (length(dir(treatDir)) > 0) {
cat("There are already directories / files in the folder. Not saving new ones.")
cat("\n")
return()
}else{
dir.create(treatDir)
data_subset <- lcms_dataset %>% MSnbase::filterFile(file = filer)
mzR::writeMSData(data_subset,
file = unlist(lapply(treatDir, FUN = paste0, filer)),
outformat = c("mzxml"), copy = FALSE)
}
}
#read samples
file_path <- system.file("extdata", package = "NIHSlcms")
rawconverter <- NULL
file_format <- "mzXML"
samples_mzxml <- lcms_list_mzxml_samples(file_path,
file_format = file_format,
rawconverter = rawconverter)
samples_mzxml <- as.character(samples_mzxml)
lcms_dataset <- suppressWarnings(lcms_read_samples(samples_mzxml, mode = "onDisk"))
metadata <- lcms_meta_read(system.file("extdata",
"metadata.xlsx",
package = "NIHSlcms"))
lcms_dataset <- lcms_meta_add(lcms_dataset,
metadata,
by = "sampleNames")
#filter retention time
rtime_range = c(4,8)
lcms_dataset <- lcms_filterRTmin(lcms_dataset, rt = rtime_range)
print(lcms_dataset)
no_blank_files <- Biobase::pData(lcms_dataset)$sampleNames
no_blank_files_treatment <- Biobase::pData(lcms_dataset)$treatment
filetreat_info <- data.frame(Filename = no_blank_files,
Treatment= no_blank_files_treatment,
stringsAsFactors = FALSE)
filetreat_info <- filetreat_info %>% dplyr::group_by(Treatment) %>% dplyr::arrange(Treatment)
filetreat_info <- split(filetreat_info, filetreat_info$Treatment)
drop_treatment <-function(x) {
x$Treatment <- NULL
colnames(x) <- "FileName"
x
}
filetreat_info <- lapply(filetreat_info, FUN = drop_treatment)
for (i in seq_along(filetreat_info)){
filer <- filetreat_info[[i]][["FileName"]]
foldname <-names(filetreat_info)[i]
treatDir <- "C:/Users/Biosignal/Desktop/mzxl_files/"
#if (length(dir(treatDir)) > 0) {
#   cat("There are already directories / files in the folder. Not saving new ones.")
#  cat("\n")
# return()
#}else{
dir.create(treatDir)
data_subset <- lcms_dataset %>% MSnbase::filterFile(file = filer)
mzR::writeMSData(data_subset,
file = unlist(lapply(treatDir, FUN = paste0, filer)),
outformat = c("mzxml"), copy = FALSE)
#}
}
sample_path <- system.file("extdata", package = "NIHSlcms")
samples_mzxml <- lcms_list_mzxml_samples(sample_path,
file_format = "mzXML")
print(samples_mzxml)
sample_path <- system.file("extdata", package = "NIHSlcms")
samples_mzxml <- lcms_list_mzxml_samples(sample_path,
file_format = "mzXML")
sample_path <- system.file("extdata", package = "NIHSlcms")
samples_mzxml <- lcms_list_mzxml_samples(sample_path,
file_format = "mzXML")
print(samples_mzxml)
dataset <- suppressWarnings(lcms_read_samples(samples_mzxml, mode = "onDisk"))
print(dataset)
file_path <- system.file("extdata", package = "NIHSlcms")
rawconverter <- NULL
file_format <- "mzXML"
samples_mzxml <- lcms_list_mzxml_samples(file_path,
file_format = file_format,
rawconverter = rawconverter)
samples_mzxml <- as.character(samples_mzxml)
dataset <- suppressWarnings(lcms_read_samples(samples_mzxml, mode = "onDisk"))
print(dataset)
saveRDS(dataset,"dataset.rds")
dataset <- lcms_dataset_load(system.file
("extdata","dataset.rds",
package = "NIHSlcms"))
metadata <- lcms_meta_read(system.file("extdata",
"metadata.xlsx",
package = "NIHSlcms"))
dataset_metadata <- lcms_meta_add(dataset,
metadata,
by = "sampleNames")
print(dataset_metadata)
saveRDS(dataset_metadata,"dataset_metadata.rds")
dataset_metadata <- lcms_dataset_load(system.file("extdata",
"dataset_metadata.rds",
package = "NIHSlcms"))
xlsx_file <- "exported_metadata.xlsx"
lcms_meta_export(dataset_metadata, xlsx_file)
print(dataset_metadata)
dataset_2_polarities <- lcms_dataset_load(system.file("extdata","dataset_metadata.rds",package = "NIHSlcms"))
dataset_pos <- lcms_filterPolarity(dataset_2_polarities, polarity. = 1)
saveRDS(dataset_pos,"dataset_pos.rds")
print(dataset_pos)
tics_pos <- lcms_tics(dataset_pos, treatment = "treatment")
treatment_col <- scales::hue_pal()(length(unique(dataset$treatment)))
names(treatment_col) <- unique(dataset$treatment)
# lcms_plot_tics(tics_pos, treatment = treatment, rt = c(5, 10), plot_type = "spec")
lcms_plot_tics(tics_pos, treatment = treatment, plot_type = "spec")
lcms_plot_tics(tics_pos, treatment = treatment, plot_type = "boxplot")
rtime_range = c(5,10)
dataset <- lcms_dataset_load(system.file("extdata","dataset_pos.rds",package = "NIHSlcms"))
dataset_pos_rt <-lcms_filter_rt_min(dataset, rt = rtime_range)
dataset_pos_rt <-lcms_filterRTmin(dataset, rt = rtime_range)
saveRDS(dataset_pos_rt,"dataset_pos_rt.rds")
dataset <- lcms_dataset_load(system.file("extdata","dataset_pos_rt.rds",package = "NIHSlcms"))
dataset <- lcms_dataset_load(system.file("extdata","dataset_pos_rt.rds",package = "NIHSlcms"))
especial_samples <-list(QC = NULL, blank = NULL)
datasets_by_class_type <- lcms_filter_sample_type(dataset, especial_samples)
datasets_by_class_type <- lcms_filterSamplType(dataset, especial_samples)
datasets_by_class_type <- lcms_filterSampleType(dataset, especial_samples)
dataset_pos_rt_rs <-datasets_by_class_type$regular_samples
dataset_pos_rt_qcs <-datasets_by_class_type$QCs
print(dataset_pos_rt_rs)
saveRDS(dataset_pos_rt_rs,"dataser_pos_rt_rs.rds")
mz_range = c(300, 400)
lcms_filter_mz <- function(dataset, mz){
dataset <- MSnbase::filterMz(dataset, mz)
}
dataset <- lcms_dataset_load(system.file("extdata","dataset_pos.rds",package = "NIHSlcms"))
dataset_pos_rt_mz <-lcms_filter_mz(dataset, mz = mz_range)
print(lcms_dataset_pos_rt_mz)
print(dataset_pos_rt_mz)
saveRDS(dataset_pos_rt_mz,"dataset_pos_rt_mz.rds")
loadRDS("C:/Users/Biosignal/Desktop/LCMS_2019/NIHSlcms/inst/extdata/dataset_metadata.rds)
)
loadRDS("C:/Users/Biosignal/Desktop/LCMS_2019/NIHSlcms/inst/extdata/dataset_metadata.rds")
readRDS("C:/Users/Biosignal/Desktop/LCMS_2019/NIHSlcms/inst/extdata/dataset_metadata.rds")
dataset_pos <- lcms_filter_polarity(dataset_2_polarities, polarity. = 1)
dataset_2_polarities <- readRDS("C:/Users/Biosignal/Desktop/LCMS_2019/NIHSlcms/inst/extdata/dataset_metadata.rds")
dataset_2_polarities
dataset_2_polarities@phenoData
dataset_pos <- lcms_filterPolarity(dataset_2_polarities, polarity. = 1)
dataset_2_polarities@phenoData@dimLabels
dataset_2_polarities@phenoData@data
dataset_2_polarities@featureData@varMetadata
dataset_2_polarities@assayData
dataset_2_polarities@featureData
dataset_2_polarities@experimentData@samples
dataset_2_polarities@featureData@varMetadata
dataset_2_polarities@phenoData@data$treatment
dataset_2_polarities@phenoData@data$sampleNames
Msnbase::polarity(dataset_2_polarities)
MSnbase::polarity(dataset_2_polarities)
MSnbase::polarity(dataset_2_polarities)%in%1
hola <- MSnbase::polarity(dataset_2_polarities)%in%1
pepe <-dataset_2_polarities[hola]
