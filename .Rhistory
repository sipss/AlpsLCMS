file_path <- system.file("extdata", "rearrange_mait", package = "NIHSlcms")
samples_mzxml <- list.files(file_path, recursive = TRUE, full.names = TRUE)
meta_path <- system.file("extdata", "metadata.xlsx", package = "NIHSlcms")
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
dataset <- suppressWarnings(lcms_read_samples(samples_mzxml, mode = "onDisk"))
metadata <- lcms_meta_read(meta_path)
dataset_meta <- lcms_meta_add(dataset, metadata, by = "sampleNames")
peakdet <- lcms_find_chrom_peaks_cwp(dataset_meta, params = preproc_params)
print(peakdet)
saveRDS(peakdet,"peakdet.rds")
library(NIHSlcms)
library(NIHSlcms)
file_name <-  system.file("extdata", "peakdet.rds", package = "NIHSlcms")
peakdet <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
peakdet_align <- lcms_align_rtime(peakdet, params = preproc_params)
print(peakdet_align)
file_name <-  system.file("extdata", "peakdet.rds", package = "NIHSlcms")
peakdet <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
peakdet_align <- lcms_align_rtime(peakdet, params = preproc_params)
peakdet_align <- lcms_align_rtime(peakdet, params = preproc_params)
library(NIHSlcms)
library(NIHSlcms)
nfile_name <-  system.file("extdata", "peakdet.rds", package = "NIHSlcms")
peakdet <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
peakdet_align <- lcms_align_rtime(peakdet, params = preproc_params)
print(peakdet_align)
file_name <-  system.file("extdata", "peakdet.rds", package = "NIHSlcms")
peakdet <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
file_name <-  system.file("extdata", "peakdet.rds", package = "NIHSlcms")
peakdet <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
peakdet_align <- lcms_align_rtime(peakdet, params = preproc_params)
print(peakdet_align)
library(NIHSlcms)
file_name <-  system.file("extdata", "peakdet_align.rds", package = "NIHSlcms")
peakdet_align <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
peak_table <- lcms_group_peaks(peakdet_align, params = preproc_params)
print(peak_table
)
saveRDS(peak_table,"peak_table.rds")
library(NIHSlcms)
library(NIHSlcms)
library(NIHSlcms)
file_name <-  system.file("extdata", "peakdet_align.rds", package = "NIHSlcms")
data <- base::readRDS(file_name)
rta_plot <- lcms_retention_time_alignment_plot(data)
print(rta_plot)
library(NIHSlcms)
file_name <-  system.file("extdata", "peakdet_align.rds", package = "NIHSlcms")
dataset <- base::readRDS(file_name)
chr_peak_image <- lmcs_plot_chrom_peak_image(dataset, binSize = 5, xlim = NULL, log = FALSE,
xlab = "retention time (min)", yaxt = par("yaxt"))
title(main ="Detected Peaks (Aligned)"
)
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
peak_table_imputed <- lcms_fill_chrom_peaks(peak_table)
print(peak_table_imputed)
saveRDS(peak_table_imputed,"peak_table_imputed")
library(NIHSlcms)
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_imputed.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
data_dir <-  system.file("extdata", "rearrange_mait", package = "NIHSlcms")
project_dir <-  system.file("extdata", package = "NIHSlcms")
project <- "project"
peak_table_mait <- lcms_to_mait(data_dir = data_dir,
project_dir = project_dir,
project = project,
preproc_params = preproc_params,
peak_table = peak_table)
print(peak_table_mait)
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_imputed.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
data_dir <-  system.file("extdata", "rearrange_mait", package = "NIHSlcms")
project_dir <-  system.file("extdata", package = "NIHSlcms")
project <- "project"
peak_table_mait <- lcms_to_mait(data_dir = data_dir,
project_dir = project_dir,
project = project,
preproc_params = preproc_params,
peak_table = peak_table)
print(peak_table_mait)
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_imputed.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
data_dir <-  system.file("extdata", "rearrange_mait", package = "NIHSlcms")
project_dir <-  system.file("extdata", package = "NIHSlcms")
project <- "project"
peak_table_mait <- lcms_to_mait(data_dir = data_dir,
project_dir = project_dir,
project = project,
preproc_params = preproc_params,
peak_table = peak_table)
print(peak_table_mait)
saveRDS(peak_table_mait,"peak_table_mait.rds")
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_imputed.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
data_dir <-  system.file("extdata", "rearrange_mait", package = "NIHSlcms")
project_dir <-  system.file("extdata", package = "NIHSlcms")
project <- "project"
peak_table_mait <- lcms_to_mait(data_dir = data_dir,
project_dir = project_dir,
project = project,
preproc_params = preproc_params,
peak_table = peak_table)
print(peak_table_mait)
file_name <-  system.file("extdata", "peak_table_imputed.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
data_dir <-  system.file("extdata", "rearrange_mait", package = "NIHSlcms")
project_dir <-  system.file("extdata", package = "NIHSlcms")
project <- "project"
file_name <-  system.file("extdata", "peak_table_imputed.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
data_dir <-  system.file("extdata", "rearrange_mait", package = "NIHSlcms")
project_dir <-  system.file("extdata", package = "NIHSlcms")
project <- "project"
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_imputed.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
data_dir <-  system.file("extdata", "rearrange_mait", package = "NIHSlcms")
project_dir <-  system.file("extdata", package = "NIHSlcms")
project <- "project"
peak_table_mait <- lcms_to_mait(data_dir = data_dir,
project_dir = project_dir,
project = project,
preproc_params = preproc_params,
peak_table = peak_table)
print(peak_table_mait)
saveRDS(peak_table_mait,"peak_table_mait.rds")
library(NIHSlcms)
library(NIHSlcms)
data_dir <-  system.file("extdata", "rearrange_mait", package = "NIHSlcms")
mait_params_path <- system.file("extdata", "results_project", package = "NIHSlcms")
opt_result_path <-  system.file("extdata", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
parameters <- c(dataDir = data_dir, preproc_params)
quiet <- function(x) {
base::sink(base::tempfile())
base::on.exit(base::sink())
base::invisible(base::force(x))}
quiet(getClassDef("MAIT","MAIT"))
MAIT.object = signature(MAIT.Object = "MAIT")
MAIT.object <- methods::new("MAIT")
MAIT.object@RawData@parameters@sampleProcessing <- parameters
lcms_write_parameter_table(MAIT::parameters(MAIT.object), folder = mait_params_path)
library(NIHSlcms)
library(NIHSlcms)
library(NIHSlcms)
file_name <-  system.file("extdata","peak_table_mait.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
peak_table_ann <- lcms_peak_annotation(MAIT.object = peak_table)
lcms_raw_data(peak_table_ann)
saveRDS(peak_table_ann,"peak_table_ann.rds")
library(NIHSlcms)
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_mait.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
peak_table_ann <- peak_annotation(MAIT.object = peak_table)
lcms_raw_data(peak_table)
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_mait.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
peak_table_ann <- lcms_peak_annotation(MAIT.object = peak_table)
lcms_raw_data(peak_table)
file_name <-  system.file("extdata", "peak_table_mait.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
peak_table_ann <- lcms_peak_annotation(MAIT.object = peak_table)
lcms_raw_data(peak_table_ann)
lcms_raw_data(peak_table_ann):
lcms_raw_data(peak_table_ann)
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_mait.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
peak_table_ann <- lcms_peak_annotation(MAIT.object = peak_table)
lcms_raw_data(peak_table)
file_name <-  system.file("extdata","peak_table_mait.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
peak_table_ann <- lcms_peak_annotation(MAIT.object = peak_table)
lcms_raw_data(peak_table_ann)
file_name <-  system.file("extdata", "peak_table_mait.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
peak_table_ann <- lcms_peak_annotation(MAIT.object = peak_table)
lcms_raw_data(peak_table_ann)
library(NIHSlcms)
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_ann.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
#peak_table@PhenoData@classes <- c("plasma","plasma..ringer...palm")
peak_table_sig_ann <- lcms_spectral_sig_features(MAIT.object = peak_table,
pvalue=0.05,
p.adj="none",
scale=FALSE)
print(peak_table_sig_ann)
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_ann.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
#peak_table@PhenoData@classes <- c("plasma","plasma..ringer...palm")
peak_table_sig_ann <- lcms_spectral_sig_features(MAIT.object = peak_table,
pvalue=0.05,
p.adj="none",
scale=FALSE)
print(peak_table_sig_ann)
saveRDS(peak_table_sig_ann,"peak_table_sig_ann.rds")
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_ann.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
peak_table_sig_ann <- lcms_spectral_sig_features(MAIT.object = peak_table,
pvalue=0.05,
p.adj="none",
scale=FALSE)
print(peak_table_sig_ann)
library(NIHSlcms)
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_sig_ann.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
sig_table <- lcms_sig_peaks_table(peak_table,  printCSVfile=FALSE)
str(sig_table)
saveRDS(sig_table,"sig_table.rds")
library(NIHSlcms)
file_name <-  system.file("extdata", "peak_table_sig_ann.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
sig_table <- lcms_sig_peaks_table(peak_table,  printCSVfile=FALSE)
str(sig_table)
library(NIHSlcms)
file_name <- system.file("extdata", "peak_table_sig_ann.rds", package = "NIHSlcms")
peak_table <- readRDS(file_name)
metabololite_table <- lcms_identify_metabolites(MAIT.object = peak_table,
peakTolerance = 0.005)
library(NIHSlcms)
file_name <- system.file("extdata", "peak_table_sig_ann.rds", package = "NIHSlcms")
peak_table <- readRDS(file_name)
metabololite_table <- lcms_identify_metabolites(MAIT.object = peak_table,
peakTolerance = 0.005)
library(NIHSlcms)
library(NIHSlcms)
path_result <-  system.file("extdata","results_project","tables","metaboliteTable.csv", package = "NIHSlcms")
plots <- lcms_plot_metabolites(path_result, biofluid_type = "Any",
significance = 0.05,
metabolite_rm = FALSE,
max_words = 250)
plots$cloud
plots$freq
library(NIHSlcms)
path_result <-  system.file("extdata","results_project","tables","metaboliteTable.csv", package = "NIHSlcms")
plots <- lcms_plot_metabolites(path_result, biofluid_type = "Any",
significance = 0.05,
metabolite_rm = FALSE,
max_words = 250)
plots$cloud
plots$freq
library(NIHSlcms)
path_result <-  system.file("extdata","results_project","tables","metaboliteTable.csv", package = "NIHSlcms")
plots <- lcms_plot_metabolites(path_result, biofluid_type = "Any",
significance = 0.05,
metabolite_rm = FALSE,
max_words = 250)
plots$cloud
plots$freq
library(NIHSlcms)
path_result <-  system.file("extdata","results_project","tables","metaboliteTable.csv", package = "NIHSlcms")
plots <- lcms_plot_metabolites(path_result, biofluid_type = "Any",
significance = 0.05,
metabolite_rm = FALSE,
max_words = 250)
plots$cloud
plots$freq
library(NIHSlcms)
path_result <-  system.file("extdata","results_project","tables","metaboliteTable.csv", package = "NIHSlcms")
plots <- lcms_plot_metabolites(path_result, biofluid_type = "Any",
significance = 0.05,
metabolite_rm = FALSE,
max_words = 250)
plots$cloud
plots$freq
path_result <-  system.file("extdata","results_project","tables","metaboliteTable.csv", package = "NIHSlcms")
plots <- lcms_plot_metabolites(path_result, biofluid_type = "Any",
significance = 0.05,
metabolite_rm = FALSE,
max_words = 250)
plots$cloud
plots$freq
library(NIHSlcms)
path_result <-  system.file("extdata","results_project","tables","metaboliteTable.csv", package = "NIHSlcms")
plots <- lcms_plot_metabolites(path_result, biofluid_type = "Any",
significance = 0.05,
metabolite_rm = FALSE,
max_words = 250)
plots$cloud
plots$freq
path_result <-  system.file("extdata","results_project","tables","metaboliteTable.csv", package = "NIHSlcms")
plots <- lcms_plot_metabolites(path_result, biofluid_type = "Any",
significance = 0.05,
metabolite_rm = FALSE,
max_words = 250)
plots$cloud
plots$freq
library(NIHSlcms)
path_result <-  system.file("extdata","results_project","tables","metaboliteTable.csv", package = "NIHSlcms")
plots <- lcms_plot_metabolites(path_result, biofluid_type = "Any",
significance = 0.05,
metabolite_rm = FALSE,
max_words = 250)
plots$cloud
plots$freq
library(NIHSlcms)
file_name_1 <-  system.file("extdata","peak_table_sig_ann.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name_1)
file_name_2 <-  system.file("extdata","dataset_pos_rt_rs.rds", package = "NIHSlcms")
dataset <-  base::readRDS(file_name_2)
treatment_col <- scales::hue_pal()(length(unique(dataset$treatment)))
pca_peak_table_pca <- lcms_peak_table_pca(peak_table,
treament_col = treatment_col,
Log = FALSE,
center = TRUE, scale = FALSE)
print(pca_peak_table)
file_name_1 <-  system.file("extdata","peak_table_sig_ann.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name_1)
file_name_2 <-  system.file("extdata","dataset_pos_rt_rs.rds", package = "NIHSlcms")
dataset <-  base::readRDS(file_name_2)
treatment_col <- scales::hue_pal()(length(unique(dataset$treatment)))
pca_peak_table_pca <- lcms_peak_table_pca(peak_table,
treament_col = treatment_col,
Log = FALSE,
center = TRUE, scale = FALSE)
print(pca_peak_table)
library(NIHSlcms)
library(NIHSlcms)
file_name_1 <-  system.file("extdata","peak_table_sig_ann.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name_1)
file_name_2 <-  system.file("extdata","dataset_pos_rt_rs.rds", package = "NIHSlcms")
dataset <-  base::readRDS(file_name_2)
treatment_col <- scales::hue_pal()(length(unique(dataset$treatment)))
pca_peak_table_pca <- lcms_peak_table_pca(peak_table,
treament_col = treatment_col,
Log = FALSE,
center = TRUE, scale = FALSE)
print(pca_peak_table)
file_name_1 <-  system.file("extdata","peak_table_sig_ann.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name_1)
file_name_2 <-  system.file("extdata","dataset_pos_rt_rs.rds", package = "NIHSlcms")
dataset <-  base::readRDS(file_name_2)
treatment_col <- scales::hue_pal()(length(unique(dataset$treatment)))
pca_peak_table_pca <- lcms_peak_table_pca(peak_table,
treament_col = treatment_col,
Log = FALSE,
center = TRUE, scale = FALSE)
print(pca_peak_table)
file_name_1 <-  system.file("extdata","peak_table_sig_ann.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name_1)
file_name_2 <-  system.file("extdata","dataset_pos_rt_rs.rds", package = "NIHSlcms")
dataset <-  base::readRDS(file_name_2)
treatment_col <- scales::hue_pal()(length(unique(dataset$treatment)))
lcms_peak_table_pca(peak_table,
treament_col = treatment_col,
Log = FALSE,
center = TRUE, scale = FALSE)
file_name_1 <-  system.file("extdata","peak_table_sig_ann.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name_1)
file_name_2 <-  system.file("extdata","dataset_pos_rt_rs.rds", package = "NIHSlcms")
dataset <-  base::readRDS(file_name_2)
treatment_col <- scales::hue_pal()(length(unique(dataset$treatment)))
lcms_peak_table_boxplots(peak_table,
treatment_col = treatment_col)
file_name_1 <-  system.file("extdata","peak_table_sig_ann.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name_1)
file_name_2 <-  system.file("extdata","dataset_pos_rt_rs.rds", package = "NIHSlcms")
dataset <-  base::readRDS(file_name_2)
treatment_col <- scales::hue_pal()(length(unique(dataset$treatment)))
lcms_peak_table_pca(peak_table,
treament_col = treatment_col,
Log = FALSE,
center = TRUE, scale = FALSE)
library(NIHSlcms)
library(NIHSlcms)
library(NIHSlcms)
file_name <- system.file("extdata", "dataset.rds", package = "NIHSlcms")
dataset <- lcms_dataset_load(file_name)
print(dataset)
library(NIHSlcms)
library(NIHSlcms)
file_name <- system.file("extdata", "dataset.rds", package = "NIHSlcms")
dataset <- lcms_dataset_load(file_name)
print(dataset)
dataset <- lcms_dataset_load(system.file("extdata", "dataset.rds", package = "NIHSlcms"))
file_name <- "dataset.rds"
lcms_dataset_save(dataset, file_name)
print(dataset)
default_peakpicking_params <- lcms_default_peakpicking_params(optimize = TRUE)
print(default_peakpicking_params)
default_retcorgroup_params <- lcms_default_retcorgroup_params(optimize = TRUE)
print(default_retcorgroup_params)
file_name <-  system.file("extdata", "peak_table.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
peak_table_imputed <- lcms_fill_chrom_peaks(peak_table)
print(peak_table_imputed)
mz_range = c(300, 400)
dataset <- lcms_dataset_load(system.file("extdata","dataset_pos.rds",package = "NIHSlcms"))
dataset_pos_mz <-lcms_filter_mz(dataset, mz = mz_range)
print(dataset_pos_mz)
dataset_2_polarities <- lcms_dataset_load(system.file("extdata","dataset_metadata.rds",package = "NIHSlcms"))
dataset_pos <- lcms_filter_polarity(dataset_2_polarities, polarity. = 1)
print(dataset_pos)
rtime_range = c(5,10)
dataset <- lcms_dataset_load(system.file("extdata","dataset_pos.rds",package = "NIHSlcms"))
dataset_pos_rt <-lcms_filter_rt_min(dataset, rt = rtime_range)
print(dataset_pos_rt)
dataset <- lcms_dataset_load(system.file("extdata","dataset_pos_rt.rds",package = "NIHSlcms"))
especial_samples <-list(QC = NULL, blank = NULL)
datasets_by_class_type <- lcms_filter_sample_type(dataset, especial_samples)
dataset_pos_rt_rs <-datasets_by_class_type$regular_samples
dataset_pos_rt_qcs <-datasets_by_class_type$QCs
print(dataset_pos_rt_rs)
print(dataset_pos_rt_qcs)
file_name <-  system.file("extdata","peak_table_mait.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
peak_table_ann <- lcms_peak_annotation(MAIT.object = peak_table)
lcms_raw_data(peak_table_ann)
file_name <-  system.file("extdata","peak_table_mait.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
peak_table_ann <- lcms_peak_annotation(MAIT.object = peak_table)
lcms_raw_data(peak_table_ann)
file_name <- system.file("extdata", "peak_table_sig_ann.rds", package = "NIHSlcms")
peak_table <- readRDS(file_name)
metabololite_table <- lcms_identify_metabolites(MAIT.object = peak_table,
peakTolerance = 0.005)
sample_path <- system.file("extdata", package = "NIHSlcms")
samples_mzxml <- lcms_list_mzxml_samples(sample_path,
file_format = "mzXML")
print(samples_mzxml)
dataset <- lcms_dataset_load(system.file
("extdata","dataset.rds",
package = "NIHSlcms"))
metadata <- lcms_meta_read(system.file("extdata",
"metadata.xlsx",
package = "NIHSlcms"))
dataset_metadata <- lcms_meta_add(dataset,
metadata,
by = "sampleNames")
print(dataset_metadata)
file_name <-  system.file("extdata","peak_table_mait.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name)
peak_table_ann <- lcms_peak_annotation(MAIT.object = peak_table)
lcms_raw_data(peak_table_ann)
file_name_1 <-  system.file("extdata","peak_table_sig_ann.rds", package = "NIHSlcms")
peak_table <- base::readRDS(file_name_1)
file_name_2 <-  system.file("extdata","dataset_pos_rt_rs.rds", package = "NIHSlcms")
dataset <-  base::readRDS(file_name_2)
treatment_col <- scales::hue_pal()(length(unique(dataset$treatment)))
lcms_peak_table_boxplots(peak_table,
treatment_col = treatment_col)
opt_result_path <-  system.file("extdata","ipo_opt", package = "NIHSlcms")
preproc_params <- lcms_read_ipo_to_xcms(opt_result_path)
print(preproc_params)
dataset <- lcms_dataset_load(system.file
("extdata","dataset_pos.rds",
package = "NIHSlcms"))
tics <- lcms_tics(dataset)
lcms_plot_tics(tics, treatment = treatment,
rt = c(4, 8),plot_type = "spec")
lcms_plot_tics(tics, treatment = treatment,
rt = c(4, 8), plot_type = "boxplot")
file_name <- system.file("extdata",
"dataset_pos.rds",
package = "NIHSlcms")
dataset <- lcms_dataset_load(file_name)
treatment_col <- scales::hue_pal()(length(unique(dataset$treatment)))
names(treatment_col) <- unique(dataset$treatment)
base_peaks <- xcms::chromatogram(dataset, aggregationFun = "max")
lcms_plot_chrom(base_peaks, treatment_col, rtlim = c(4, 8))
datasefile_name <- system.file("extdata",
"dataset_pos.rds",
package = "NIHSlcms")
dataset <- lcms_dataset_load(file_name)
treatment_col <- scales::hue_pal()(length(unique(dataset$treatment)))
file_name <- system.file("extdata",
"dataset_pos.rds",
package = "NIHSlcms")
dataset <- lcms_dataset_load(file_name)
treatment_col <- scales::hue_pal()(length(unique(dataset$treatment)))
names(treatment_col) <- unique(dataset$treatment)
base_peaks <- xcms::chromatogram(dataset, aggregationFun = "max")
lcms_plot_chrom(base_peaks, treatment_col, rtlim = c(4, 8))
