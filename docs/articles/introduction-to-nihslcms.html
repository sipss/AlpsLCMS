<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to NIHSlcms • NIHSlcms</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to NIHSlcms">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">NIHSlcms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9007</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction-to-nihslcms.html">Introduction to NIHSlcms</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to NIHSlcms</h1>
                        <h4 class="author">Institute for Bioengineering of Catalonia</h4>
            
            <h4 class="date">2020-10-20</h4>
      
      
      <div class="hidden name"><code>introduction-to-nihslcms.Rmd</code></div>

    </div>

    
    
<p>The <code>NIHSlcms</code> package was written with two purposes in mind:</p>
<ul>
<li>to help <strong>data analysts and LC-MS scientists</strong> to work with LC-MS samples.</li>
<li>to help <strong>IT pipeline builders</strong> implement automated methods for preprocessing.</li>
</ul>
<p>Functions from this package written for data analysts and LC-MS scientists are prefixed with <code>lcms_</code>, while higher level functions written for IT pipeline builders are prefixed with <code>pipe_</code>. The main reason why all exported functions have a prefix is to make it easy for the user to discover the functions from the package. By typing lcms_ RStudio will return the list of exported functions. In the R terminal, lcms_ followed by the tab key (⇥) twice will have the same effect. Other popular packages, follow similar approaches (e.g: <code>forcats</code>: <code>fct_*</code>, <code>stringr</code>: <code>str_*</code>).</p>
<p>This vignette is written for the first group. It assumes some prior basic knowledge of LC-MS and data analysis, as well as some basic R programming. In case you are interested in building pipelines with this package, you may want to open the file saved in this directory (run it on your computer):</p>
<pre><code>pipeline_example &lt;- system.file("pipeline-rmd", "pipeline_example.R", package = "NIHSlcms")
print(pipeline_example)</code></pre>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(NIHSlcms)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</a></code></pre></div>
<div id="node-1-data-wrangling" class="section level1">
<h1 class="hasAnchor">
<a href="#node-1-data-wrangling" class="anchor"></a>NODE 1: Data wrangling</h1>
<div id="convert-raw-to-mzxml" class="section level2">
<h2 class="hasAnchor">
<a href="#convert-raw-to-mzxml" class="anchor"></a>Convert RAW to mzXML</h2>
<p>First, we need the listed spectra in “.mzXML” format to create the <code>lcms_dataset</code>. We can manually convert “.raw” into “.mzXML” using RawConverter or ProteoWizard externally and saved them within the same input directory. We set the polarity manually.</p>
</div>
<div id="input" class="section level2">
<h2 class="hasAnchor">
<a href="#input" class="anchor"></a>Input</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(faahKO)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">#&gt; Loading required package: xcms</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">#&gt; Loading required package: Biobase</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">#&gt; Loading required package: BiocGenerics</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">#&gt; Loading required package: parallel</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">#&gt; Attaching package: 'BiocGenerics'</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">#&gt; The following objects are masked from 'package:parallel':</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">#&gt;     clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">#&gt;     clusterExport, clusterMap, parApply, parCapply, parLapply,</span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">#&gt;     parLapplyLB, parRapply, parSapply, parSapplyLB</span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">#&gt; The following objects are masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="co">#&gt;     IQR, mad, sd, var, xtabs</span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co">#&gt; The following objects are masked from 'package:base':</span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="co">#&gt;     anyDuplicated, append, as.data.frame, basename, cbind, colnames,</span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="co">#&gt;     dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,</span></a>
<a class="sourceLine" id="cb3-20" title="20"><span class="co">#&gt;     grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,</span></a>
<a class="sourceLine" id="cb3-21" title="21"><span class="co">#&gt;     order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,</span></a>
<a class="sourceLine" id="cb3-22" title="22"><span class="co">#&gt;     rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,</span></a>
<a class="sourceLine" id="cb3-23" title="23"><span class="co">#&gt;     union, unique, unsplit, which, which.max, which.min</span></a>
<a class="sourceLine" id="cb3-24" title="24"><span class="co">#&gt; Welcome to Bioconductor</span></a>
<a class="sourceLine" id="cb3-25" title="25"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-26" title="26"><span class="co">#&gt;     Vignettes contain introductory material; view with</span></a>
<a class="sourceLine" id="cb3-27" title="27"><span class="co">#&gt;     'browseVignettes()'. To cite Bioconductor, see</span></a>
<a class="sourceLine" id="cb3-28" title="28"><span class="co">#&gt;     'citation("Biobase")', and for packages 'citation("pkgname")'.</span></a>
<a class="sourceLine" id="cb3-29" title="29"><span class="co">#&gt; Loading required package: BiocParallel</span></a>
<a class="sourceLine" id="cb3-30" title="30"><span class="co">#&gt; Loading required package: MSnbase</span></a>
<a class="sourceLine" id="cb3-31" title="31"><span class="co">#&gt; Loading required package: mzR</span></a>
<a class="sourceLine" id="cb3-32" title="32"><span class="co">#&gt; Loading required package: Rcpp</span></a>
<a class="sourceLine" id="cb3-33" title="33"><span class="co">#&gt; Warning in fun(libname, pkgname): mzR has been built against a different Rcpp version (1.0.2)</span></a>
<a class="sourceLine" id="cb3-34" title="34"><span class="co">#&gt; than is installed on your system (1.0.5). This might lead to errors</span></a>
<a class="sourceLine" id="cb3-35" title="35"><span class="co">#&gt; when loading mzR. If you encounter such issues, please send a report,</span></a>
<a class="sourceLine" id="cb3-36" title="36"><span class="co">#&gt; including the output of sessionInfo() to the Bioc support forum at </span></a>
<a class="sourceLine" id="cb3-37" title="37"><span class="co">#&gt; https://support.bioconductor.org/. For details see also</span></a>
<a class="sourceLine" id="cb3-38" title="38"><span class="co">#&gt; https://github.com/sneumann/mzR/wiki/mzR-Rcpp-compiler-linker-issue.</span></a>
<a class="sourceLine" id="cb3-39" title="39"><span class="co">#&gt; Warning: multiple methods tables found for 'analyzer'</span></a>
<a class="sourceLine" id="cb3-40" title="40"><span class="co">#&gt; Warning: multiple methods tables found for 'tolerance'</span></a>
<a class="sourceLine" id="cb3-41" title="41"><span class="co">#&gt; Loading required package: S4Vectors</span></a>
<a class="sourceLine" id="cb3-42" title="42"><span class="co">#&gt; Loading required package: stats4</span></a>
<a class="sourceLine" id="cb3-43" title="43"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-44" title="44"><span class="co">#&gt; Attaching package: 'S4Vectors'</span></a>
<a class="sourceLine" id="cb3-45" title="45"><span class="co">#&gt; The following object is masked from 'package:base':</span></a>
<a class="sourceLine" id="cb3-46" title="46"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-47" title="47"><span class="co">#&gt;     expand.grid</span></a>
<a class="sourceLine" id="cb3-48" title="48"><span class="co">#&gt; Loading required package: ProtGenerics</span></a>
<a class="sourceLine" id="cb3-49" title="49"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-50" title="50"><span class="co">#&gt; Attaching package: 'ProtGenerics'</span></a>
<a class="sourceLine" id="cb3-51" title="51"><span class="co">#&gt; The following objects are masked from 'package:mzR':</span></a>
<a class="sourceLine" id="cb3-52" title="52"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-53" title="53"><span class="co">#&gt;     analyzer, tolerance</span></a>
<a class="sourceLine" id="cb3-54" title="54"><span class="co">#&gt; The following object is masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb3-55" title="55"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-56" title="56"><span class="co">#&gt;     smooth</span></a>
<a class="sourceLine" id="cb3-57" title="57"><span class="co">#&gt; Warning: replacing previous import 'ProtGenerics::tolerance' by 'mzR::tolerance'</span></a>
<a class="sourceLine" id="cb3-58" title="58"><span class="co">#&gt; when loading 'MSnbase'</span></a>
<a class="sourceLine" id="cb3-59" title="59"><span class="co">#&gt; Warning: replacing previous import 'ProtGenerics::analyzer' by 'mzR::analyzer'</span></a>
<a class="sourceLine" id="cb3-60" title="60"><span class="co">#&gt; when loading 'MSnbase'</span></a>
<a class="sourceLine" id="cb3-61" title="61"><span class="co">#&gt; Warning: multiple methods tables found for 'msInfo'</span></a>
<a class="sourceLine" id="cb3-62" title="62"><span class="co">#&gt; Warning: multiple methods tables found for 'expemail'</span></a>
<a class="sourceLine" id="cb3-63" title="63"><span class="co">#&gt; Warning: multiple methods tables found for 'exptitle'</span></a>
<a class="sourceLine" id="cb3-64" title="64"><span class="co">#&gt; Warning: multiple methods tables found for 'ionSource'</span></a>
<a class="sourceLine" id="cb3-65" title="65"><span class="co">#&gt; Warning: multiple methods tables found for 'ionSourceDetails'</span></a>
<a class="sourceLine" id="cb3-66" title="66"><span class="co">#&gt; Warning: multiple methods tables found for 'analyser'</span></a>
<a class="sourceLine" id="cb3-67" title="67"><span class="co">#&gt; Warning: multiple methods tables found for 'analyzer'</span></a>
<a class="sourceLine" id="cb3-68" title="68"><span class="co">#&gt; Warning: multiple methods tables found for 'analyserDetails'</span></a>
<a class="sourceLine" id="cb3-69" title="69"><span class="co">#&gt; Warning: multiple methods tables found for 'analyzerDetails'</span></a>
<a class="sourceLine" id="cb3-70" title="70"><span class="co">#&gt; Warning: multiple methods tables found for 'detectorType'</span></a>
<a class="sourceLine" id="cb3-71" title="71"><span class="co">#&gt; Warning: multiple methods tables found for 'instrumentModel'</span></a>
<a class="sourceLine" id="cb3-72" title="72"><span class="co">#&gt; Warning: multiple methods tables found for 'instrumentManufacturer'</span></a>
<a class="sourceLine" id="cb3-73" title="73"><span class="co">#&gt; Warning: multiple methods tables found for 'instrumentCustomisations'</span></a>
<a class="sourceLine" id="cb3-74" title="74"><span class="co">#&gt; Warning: multiple methods tables found for 'processingData'</span></a>
<a class="sourceLine" id="cb3-75" title="75"><span class="co">#&gt; Warning: multiple methods tables found for 'smooth'</span></a>
<a class="sourceLine" id="cb3-76" title="76"><span class="co">#&gt; Warning: multiple methods tables found for 'ionCount'</span></a>
<a class="sourceLine" id="cb3-77" title="77"><span class="co">#&gt; Warning: multiple methods tables found for 'centroided'</span></a>
<a class="sourceLine" id="cb3-78" title="78"><span class="co">#&gt; Warning: multiple methods tables found for 'centroided&lt;-'</span></a>
<a class="sourceLine" id="cb3-79" title="79"><span class="co">#&gt; Warning: multiple methods tables found for 'smoothed'</span></a>
<a class="sourceLine" id="cb3-80" title="80"><span class="co">#&gt; Warning: multiple methods tables found for 'smoothed&lt;-'</span></a>
<a class="sourceLine" id="cb3-81" title="81"><span class="co">#&gt; Warning: multiple methods tables found for 'precursorMz'</span></a>
<a class="sourceLine" id="cb3-82" title="82"><span class="co">#&gt; Warning: multiple methods tables found for 'precursorIntensity'</span></a>
<a class="sourceLine" id="cb3-83" title="83"><span class="co">#&gt; Warning: multiple methods tables found for 'precursorCharge'</span></a>
<a class="sourceLine" id="cb3-84" title="84"><span class="co">#&gt; Warning: multiple methods tables found for 'precScanNum'</span></a>
<a class="sourceLine" id="cb3-85" title="85"><span class="co">#&gt; Warning: multiple methods tables found for 'acquisitionNum'</span></a>
<a class="sourceLine" id="cb3-86" title="86"><span class="co">#&gt; Warning: multiple methods tables found for 'scanIndex'</span></a>
<a class="sourceLine" id="cb3-87" title="87"><span class="co">#&gt; Warning: multiple methods tables found for 'msLevel'</span></a>
<a class="sourceLine" id="cb3-88" title="88"><span class="co">#&gt; Warning: multiple methods tables found for 'collisionEnergy'</span></a>
<a class="sourceLine" id="cb3-89" title="89"><span class="co">#&gt; Warning: multiple methods tables found for 'polarity'</span></a>
<a class="sourceLine" id="cb3-90" title="90"><span class="co">#&gt; Warning: multiple methods tables found for 'filterMsLevel'</span></a>
<a class="sourceLine" id="cb3-91" title="91"><span class="co">#&gt; Warning: multiple methods tables found for 'filterMz'</span></a>
<a class="sourceLine" id="cb3-92" title="92"><span class="co">#&gt; Warning: multiple methods tables found for 'filterPolarity'</span></a>
<a class="sourceLine" id="cb3-93" title="93"><span class="co">#&gt; Warning: multiple methods tables found for 'filterRt'</span></a>
<a class="sourceLine" id="cb3-94" title="94"><span class="co">#&gt; Warning: multiple methods tables found for 'filterAcquisitionNum'</span></a>
<a class="sourceLine" id="cb3-95" title="95"><span class="co">#&gt; Warning: multiple methods tables found for 'filterEmptySpectra'</span></a>
<a class="sourceLine" id="cb3-96" title="96"><span class="co">#&gt; Warning: multiple methods tables found for 'filterPrecursorScan'</span></a>
<a class="sourceLine" id="cb3-97" title="97"><span class="co">#&gt; Warning: multiple methods tables found for 'productMz'</span></a>
<a class="sourceLine" id="cb3-98" title="98"><span class="co">#&gt; Warning: multiple methods tables found for 'isolationWindowLowerMz'</span></a>
<a class="sourceLine" id="cb3-99" title="99"><span class="co">#&gt; Warning: multiple methods tables found for 'isolationWindowUpperMz'</span></a>
<a class="sourceLine" id="cb3-100" title="100"><span class="co">#&gt; Warning: multiple methods tables found for 'filterPrecursorMz'</span></a>
<a class="sourceLine" id="cb3-101" title="101"><span class="co">#&gt; Warning: multiple methods tables found for 'filterIsolationWindow'</span></a>
<a class="sourceLine" id="cb3-102" title="102"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-103" title="103"><span class="co">#&gt; This is MSnbase version 2.10.1 </span></a>
<a class="sourceLine" id="cb3-104" title="104"><span class="co">#&gt;   Visit https://lgatto.github.io/MSnbase/ to get started.</span></a>
<a class="sourceLine" id="cb3-105" title="105"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-106" title="106"><span class="co">#&gt; Attaching package: 'MSnbase'</span></a>
<a class="sourceLine" id="cb3-107" title="107"><span class="co">#&gt; The following objects are masked from 'package:ProtGenerics':</span></a>
<a class="sourceLine" id="cb3-108" title="108"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-109" title="109"><span class="co">#&gt;     acquisitionNum, analyser, analyserDetails, analyzerDetails,</span></a>
<a class="sourceLine" id="cb3-110" title="110"><span class="co">#&gt;     centroided, centroided&lt;-, collisionEnergy, detectorType, expemail,</span></a>
<a class="sourceLine" id="cb3-111" title="111"><span class="co">#&gt;     exptitle, filterAcquisitionNum, filterEmptySpectra,</span></a>
<a class="sourceLine" id="cb3-112" title="112"><span class="co">#&gt;     filterIsolationWindow, filterMsLevel, filterMz, filterPolarity,</span></a>
<a class="sourceLine" id="cb3-113" title="113"><span class="co">#&gt;     filterPrecursorMz, filterPrecursorScan, filterRt,</span></a>
<a class="sourceLine" id="cb3-114" title="114"><span class="co">#&gt;     instrumentCustomisations, instrumentManufacturer, instrumentModel,</span></a>
<a class="sourceLine" id="cb3-115" title="115"><span class="co">#&gt;     ionCount, ionSource, ionSourceDetails, isolationWindowLowerMz,</span></a>
<a class="sourceLine" id="cb3-116" title="116"><span class="co">#&gt;     isolationWindowUpperMz, msInfo, msLevel, polarity, precScanNum,</span></a>
<a class="sourceLine" id="cb3-117" title="117"><span class="co">#&gt;     precursorCharge, precursorIntensity, precursorMz, processingData,</span></a>
<a class="sourceLine" id="cb3-118" title="118"><span class="co">#&gt;     productMz, scanIndex, smooth, smoothed, smoothed&lt;-</span></a>
<a class="sourceLine" id="cb3-119" title="119"><span class="co">#&gt; The following object is masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb3-120" title="120"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-121" title="121"><span class="co">#&gt;     smooth</span></a>
<a class="sourceLine" id="cb3-122" title="122"><span class="co">#&gt; The following object is masked from 'package:base':</span></a>
<a class="sourceLine" id="cb3-123" title="123"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-124" title="124"><span class="co">#&gt;     trimws</span></a>
<a class="sourceLine" id="cb3-125" title="125"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-126" title="126"><span class="co">#&gt; This is xcms version 3.6.2</span></a>
<a class="sourceLine" id="cb3-127" title="127"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-128" title="128"><span class="co">#&gt; Attaching package: 'xcms'</span></a>
<a class="sourceLine" id="cb3-129" title="129"><span class="co">#&gt; The following objects are masked from 'package:ProtGenerics':</span></a>
<a class="sourceLine" id="cb3-130" title="130"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-131" title="131"><span class="co">#&gt;     peaks&lt;-, polarity&lt;-</span></a>
<a class="sourceLine" id="cb3-132" title="132"><span class="co">#&gt; The following object is masked from 'package:stats':</span></a>
<a class="sourceLine" id="cb3-133" title="133"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-134" title="134"><span class="co">#&gt;     sigma</span></a>
<a class="sourceLine" id="cb3-135" title="135">path &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.files.html">dir</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"cdf"</span>, <span class="dt">package =</span> <span class="st">"faahKO"</span>), <span class="dt">full.names =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb3-136" title="136">            <span class="dt">recursive =</span> <span class="ot">TRUE</span>)[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">7</span><span class="op">:</span><span class="dv">9</span>)]</a>
<a class="sourceLine" id="cb3-137" title="137">polarity &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co"># 1 for positive mode, 0 for negative mode</span></a></code></pre></div>
</div>
<div id="code-to-run" class="section level2">
<h2 class="hasAnchor">
<a href="#code-to-run" class="anchor"></a>Code to run</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># Be careful setting the mode to "onDisk" when you apply this function.</span></a>
<a class="sourceLine" id="cb4-2" title="2">dataset &lt;-<span class="st"> </span><span class="kw">readMSData</span>(path, <span class="dt">mode =</span> <span class="st">"onDisk"</span>)</a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">#&gt; Polarity can not be extracted from netCDF files, please set manually the polarity with the 'polarity' method.</span></a>
<a class="sourceLine" id="cb4-4" title="4">dataset<span class="op">@</span>featureData<span class="op">@</span>data[[<span class="st">"polarity"</span>]] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(polarity, <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(dataset<span class="op">@</span>featureData<span class="op">@</span>data[[<span class="st">"polarity"</span>]]))</a>
<a class="sourceLine" id="cb4-5" title="5"><span class="kw"><a href="https://rdrr.io/r/base/message.html">message</a></span>(<span class="st">"Is the polarity correctly loaded? </span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">#&gt; Is the polarity correctly loaded?</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="kw"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb4-8" title="8"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(dataset)</a>
<a class="sourceLine" id="cb4-9" title="9"><span class="co">#&gt; MSn experiment data ("OnDiskMSnExp")</span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="co">#&gt; Object size in memory: 2.24 Mb</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co">#&gt; - - - Spectra data - - -</span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="co">#&gt;  MS level(s): 1 </span></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="co">#&gt;  Number of spectra: 7668 </span></a>
<a class="sourceLine" id="cb4-14" title="14"><span class="co">#&gt;  MSn retention times: 41:41 - 74:60 minutes</span></a>
<a class="sourceLine" id="cb4-15" title="15"><span class="co">#&gt; - - - Processing information - - -</span></a>
<a class="sourceLine" id="cb4-16" title="16"><span class="co">#&gt; Data loaded [Tue Oct 20 20:36:50 2020] </span></a>
<a class="sourceLine" id="cb4-17" title="17"><span class="co">#&gt;  MSnbase version: 2.10.1 </span></a>
<a class="sourceLine" id="cb4-18" title="18"><span class="co">#&gt; - - - Meta data  - - -</span></a>
<a class="sourceLine" id="cb4-19" title="19"><span class="co">#&gt; phenoData</span></a>
<a class="sourceLine" id="cb4-20" title="20"><span class="co">#&gt;   rowNames: ko15.CDF ko16.CDF ... wt18.CDF (6 total)</span></a>
<a class="sourceLine" id="cb4-21" title="21"><span class="co">#&gt;   varLabels: sampleNames</span></a>
<a class="sourceLine" id="cb4-22" title="22"><span class="co">#&gt;   varMetadata: labelDescription</span></a>
<a class="sourceLine" id="cb4-23" title="23"><span class="co">#&gt; Loaded from:</span></a>
<a class="sourceLine" id="cb4-24" title="24"><span class="co">#&gt;   [1] ko15.CDF...  [6] wt18.CDF</span></a>
<a class="sourceLine" id="cb4-25" title="25"><span class="co">#&gt;   Use 'fileNames(.)' to see all files.</span></a>
<a class="sourceLine" id="cb4-26" title="26"><span class="co">#&gt; protocolData: none</span></a>
<a class="sourceLine" id="cb4-27" title="27"><span class="co">#&gt; featureData</span></a>
<a class="sourceLine" id="cb4-28" title="28"><span class="co">#&gt;   featureNames: F1.S0001 F1.S0002 ... F6.S1278 (7668 total)</span></a>
<a class="sourceLine" id="cb4-29" title="29"><span class="co">#&gt;   fvarLabels: fileIdx spIdx ... spectrum (31 total)</span></a>
<a class="sourceLine" id="cb4-30" title="30"><span class="co">#&gt;   fvarMetadata: labelDescription</span></a>
<a class="sourceLine" id="cb4-31" title="31"><span class="co">#&gt; experimentData: use 'experimentData(object)'</span></a></code></pre></div>
</div>
</div>
<div id="node-2-append-metadata" class="section level1">
<h1 class="hasAnchor">
<a href="#node-2-append-metadata" class="anchor"></a>NODE 2: Append metadata</h1>
<p>To merge the metadata, an Excel o CSV file is required, containing the first column (called “sampleNames”) with the same name of the LC-MS files, <strong>ending with the format (e.g. Sample1.mzXML)</strong>.</p>
<p>It requires a column (called “treatment”) with the class sample. Ensure you have this specific colname <strong>“treatment”</strong>.</p>
<p>Caution with metadata. The use of characters such as “-”, “/”, " " (space) and starting with <strong>numbers</strong>, etc. leads to problems. Therefore, the function replace <code>[\\\"\\s/\\\\,;.:|#@$%&amp;?!*%+-=&gt;&lt;^'(){}\\[\\]]+</code> by <code>_</code>. Beware of using other special characters and change them by usual ASCII characters.</p>
<div id="input-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#input-parameters" class="anchor"></a>Input parameters</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">metadata &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">sampleNames =</span> <span class="kw"><a href="https://rdrr.io/r/base/basename.html">basename</a></span>(path),</a>
<a class="sourceLine" id="cb5-2" title="2">                 <span class="dt">treatment =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ko"</span>, <span class="st">"ko"</span>, <span class="st">"ko"</span>, <span class="st">"wt"</span>, <span class="st">"wt"</span>, <span class="st">"wt"</span>),</a>
<a class="sourceLine" id="cb5-3" title="3">                 <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
</div>
<div id="code-to-run-1" class="section level2">
<h2 class="hasAnchor">
<a href="#code-to-run-1" class="anchor"></a>Code to run</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">dataset &lt;-<span class="st"> </span><span class="kw"><a href="../reference/lcms_meta_add.html">lcms_meta_add</a></span>(dataset, metadata, <span class="dt">by =</span> <span class="st">"sampleNames"</span>)</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw"><a href="../reference/phData.html">phData</a></span>(dataset)</a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co">#&gt;   sampleNames treatment</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co">#&gt; 1    ko15.CDF        ko</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co">#&gt; 2    ko16.CDF        ko</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">#&gt; 3    ko18.CDF        ko</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">#&gt; 4    wt15.CDF        wt</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co">#&gt; 5    wt16.CDF        wt</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">#&gt; 6    wt18.CDF        wt</span></a></code></pre></div>
</div>
</div>
<div id="node-3-total-ion-chromatogram" class="section level1">
<h1 class="hasAnchor">
<a href="#node-3-total-ion-chromatogram" class="anchor"></a>NODE 3: Total ion chromatogram</h1>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">tics &lt;-<span class="st"> </span><span class="kw"><a href="../reference/lcms_tics.html">lcms_tics</a></span>(dataset, <span class="dt">treatment =</span> <span class="st">"treatment"</span>)</a>
<a class="sourceLine" id="cb7-2" title="2"></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="kw"><a href="../reference/lcms_plot_tics.html">lcms_plot_tics</a></span>(tics,</a>
<a class="sourceLine" id="cb7-4" title="4">               <span class="dt">treatment =</span> treatment, </a>
<a class="sourceLine" id="cb7-5" title="5">               <span class="dt">plot_type =</span> <span class="st">"spec"</span>)</a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">#&gt; Warning: Removed 72 row(s) containing missing values (geom_path).</span></a></code></pre></div>
<p><img src="introduction-to-nihslcms_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw"><a href="../reference/lcms_plot_tics.html">lcms_plot_tics</a></span>(tics, <span class="dt">treatment =</span> treatment,</a>
<a class="sourceLine" id="cb8-3" title="3">               <span class="dt">plot_type =</span> <span class="st">"boxplot"</span>)</a></code></pre></div>
<p><img src="introduction-to-nihslcms_files/figure-html/unnamed-chunk-5-2.png" width="672"></p>
</div>
<div id="node-4-filtering" class="section level1">
<h1 class="hasAnchor">
<a href="#node-4-filtering" class="anchor"></a>NODE 4: Filtering</h1>
<div id="filter-by-retention-time-mz" class="section level2">
<h2 class="hasAnchor">
<a href="#filter-by-retention-time-mz" class="anchor"></a>Filter by retention time / m/z</h2>
<p>For coherence with the pipeline, time is measured in minutes. <code>XCMS</code> and <code>IPO</code> packages work in seconds by default, while <code>CAMERA</code> and <code>MAIT</code> in minutes. Under the hood, the still do in this way, but we preset all our results in minutes.</p>
</div>
<div id="input-1" class="section level2">
<h2 class="hasAnchor">
<a href="#input-1" class="anchor"></a>Input</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co"># Range of the retention time (minutes) to include in further analyses</span></a>
<a class="sourceLine" id="cb9-2" title="2">rt =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">50</span>, <span class="dv">60</span>)</a>
<a class="sourceLine" id="cb9-3" title="3">ms =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">200</span>, <span class="dv">500</span>)</a></code></pre></div>
</div>
<div id="code-to-run-2" class="section level2">
<h2 class="hasAnchor">
<a href="#code-to-run-2" class="anchor"></a>Code to run</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">dataset_shorter &lt;-<span class="st"> </span><span class="kw"><a href="../reference/lcms_filter_rt_min.html">lcms_filter_rt_min</a></span>(dataset, <span class="dt">rt =</span> rt)</a>
<a class="sourceLine" id="cb10-2" title="2">dataset_shorter &lt;-<span class="st"> </span><span class="kw"><a href="../reference/lcms_filter_mz.html">lcms_filter_mz</a></span>(dataset_shorter, <span class="dt">mz =</span> ms)</a>
<a class="sourceLine" id="cb10-3" title="3">tics &lt;-<span class="st"> </span><span class="kw"><a href="../reference/lcms_tics.html">lcms_tics</a></span>(dataset_shorter, <span class="dt">treatment =</span> <span class="st">"treatment"</span>)</a>
<a class="sourceLine" id="cb10-4" title="4"></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="kw"><a href="../reference/lcms_plot_tics.html">lcms_plot_tics</a></span>(tics,</a>
<a class="sourceLine" id="cb10-6" title="6">               <span class="dt">treatment =</span> treatment, </a>
<a class="sourceLine" id="cb10-7" title="7">               <span class="dt">plot_type =</span> <span class="st">"spec"</span>)</a></code></pre></div>
<p><img src="introduction-to-nihslcms_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
</div>
</div>
<div id="node-5-data-preprocessing---xcms" class="section level1">
<h1 class="hasAnchor">
<a href="#node-5-data-preprocessing---xcms" class="anchor"></a>NODE 5: Data Preprocessing - XCMS</h1>
<p>It includes:</p>
<ul>
<li>Peak Detection</li>
<li>Retention Time Correction</li>
<li>Peak Correspondence</li>
<li>Imputation</li>
</ul>
<p>Parameters can be changed here. After manual inspection of certain compounds that we know that they should naturally appear, such as plotting leucine and isoleucine (as we are using plasma samples), we can set parameters more accurally.</p>
<div id="checking-xxx-at-5-8-min-and-mz" class="section level2">
<h2 class="hasAnchor">
<a href="#checking-xxx-at-5-8-min-and-mz" class="anchor"></a>Checking xxx at 5.8 min and m/z</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">metabolite &lt;-<span class="st"> "C22:0"</span></a>
<a class="sourceLine" id="cb11-2" title="2">retention_time &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb11-3" title="3">mz &lt;-<span class="st"> </span><span class="fl">446.3309</span></a>
<a class="sourceLine" id="cb11-4" title="4">dataset &lt;-<span class="st"> </span>dataset</a></code></pre></div>
</div>
<div id="code-to-run-3" class="section level2">
<h2 class="hasAnchor">
<a href="#code-to-run-3" class="anchor"></a>Code to run</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co"># retention_time_max &lt;- (retention_time*60)+120</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co"># retention_time_min &lt;- (retention_time*60)-120</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="co"># rtr &lt;- c(retention_time_min, retention_time_max)</span></a>
<a class="sourceLine" id="cb12-4" title="4"></a>
<a class="sourceLine" id="cb12-5" title="5">mz_max &lt;-<span class="st"> </span>mz <span class="op">+</span><span class="st"> </span><span class="fl">0.01</span></a>
<a class="sourceLine" id="cb12-6" title="6">mz_min &lt;-<span class="st"> </span>mz <span class="op">-</span><span class="st"> </span><span class="fl">0.01</span></a>
<a class="sourceLine" id="cb12-7" title="7">mzr &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(mz_min, mz_max)</a>
<a class="sourceLine" id="cb12-8" title="8"></a>
<a class="sourceLine" id="cb12-9" title="9"><span class="co">## extract the chromatogram</span></a>
<a class="sourceLine" id="cb12-10" title="10">chr_raw &lt;-<span class="st"> </span><span class="kw">chromatogram</span>(dataset,</a>
<a class="sourceLine" id="cb12-11" title="11">                        <span class="co"># rt = rtr,</span></a>
<a class="sourceLine" id="cb12-12" title="12">                        <span class="dt">mz =</span> mzr)</a>
<a class="sourceLine" id="cb12-13" title="13"></a>
<a class="sourceLine" id="cb12-14" title="14"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(chr_raw, <span class="dt">col =</span> <span class="st">"blue"</span>, <span class="dt">main =</span> metabolite)</a>
<a class="sourceLine" id="cb12-15" title="15"><span class="co">#&gt; Warning in .local(x, ...): All chromatograms empty</span></a></code></pre></div>
<p><img src="introduction-to-nihslcms_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co"># plot(chr_raw_leucines, col = "blue", xlim = c(330,370), ylim = c(0,1e+8), main = metabolite)</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="co"># plot(chr_raw_leucines[[2]], col = "blue", xlim = c(330,370), ylim = c(0,1e+8), main = metabolite)</span></a></code></pre></div>
</div>
</div>
<div id="node-5-optimization-of-parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#node-5-optimization-of-parameters" class="anchor"></a>NODE 5: Optimization of parameters</h1>
<div id="optimization-of-peak-detection-parameters-for-xcms" class="section level2">
<h2 class="hasAnchor">
<a href="#optimization-of-peak-detection-parameters-for-xcms" class="anchor"></a>Optimization of <strong>Peak Detection</strong> parameters for xcms</h2>
</div>
<div id="input-2" class="section level2">
<h2 class="hasAnchor">
<a href="#input-2" class="anchor"></a>Input</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">opt_path &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/tempfile.html">tempdir</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"opt_path"</span>, <span class="dt">package =</span> <span class="st">"NIHSlcms"</span>))</a>
<a class="sourceLine" id="cb14-2" title="2">optimize &lt;-<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb14-3" title="3">nSlaves &lt;-<span class="st"> </span><span class="dv">1</span></a></code></pre></div>
</div>
<div id="code-to-run-4" class="section level2">
<h2 class="hasAnchor">
<a href="#code-to-run-4" class="anchor"></a>Code to run</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">default_peakpeaking_params &lt;-<span class="st"> </span><span class="kw"><a href="../reference/lcms_default_peakpicking_params.html">lcms_default_peakpicking_params</a></span>(<span class="dt">noise =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5e+05</span>, <span class="fl">1e+06</span>),</a>
<a class="sourceLine" id="cb15-2" title="2">                                                              <span class="dt">snthresh =</span> <span class="dv">3</span>, </a>
<a class="sourceLine" id="cb15-3" title="3">                                                              <span class="dt">min_peakwidth =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">5</span>, <span class="dv">20</span>), </a>
<a class="sourceLine" id="cb15-4" title="4">                                                              <span class="dt">max_peakwidth =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">35</span>, <span class="dv">60</span>), </a>
<a class="sourceLine" id="cb15-5" title="5">                                                              <span class="dt">optimize =</span> optimize)</a>
<a class="sourceLine" id="cb15-6" title="6"><span class="co"># </span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="co"># default_peakpeaking_params$prefilter &lt;- 3 </span></a>
<a class="sourceLine" id="cb15-8" title="8"><span class="co"># default_peakpeaking_params$value_of_prefilter &lt;- 1000</span></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="co"># default_peakpeaking_params$integrate &lt;- 1</span></a>
<a class="sourceLine" id="cb15-10" title="10"><span class="co"># </span></a>
<a class="sourceLine" id="cb15-11" title="11"><span class="co"># resultPeakpicking &lt;- lcms_peakpicking_optimization(</span></a>
<a class="sourceLine" id="cb15-12" title="12"><span class="co">#   dataset = dataset,</span></a>
<a class="sourceLine" id="cb15-13" title="13"><span class="co">#   peakpickingParameters = default_peakpeaking_params,</span></a>
<a class="sourceLine" id="cb15-14" title="14"><span class="co">#   nSlaves = nSlaves,</span></a>
<a class="sourceLine" id="cb15-15" title="15"><span class="co">#   opt_path = opt_path,</span></a>
<a class="sourceLine" id="cb15-16" title="16"><span class="co">#   subdir = NULL,</span></a>
<a class="sourceLine" id="cb15-17" title="17"><span class="co">#   plots = FALSE)</span></a></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co"># optimizedXcmsSet &lt;- resultPeakpicking$best_settings$xset</span></a></code></pre></div>
</div>
</div>
<div id="final-thoughts" class="section level1">
<h1 class="hasAnchor">
<a href="#final-thoughts" class="anchor"></a>Final thoughts</h1>
<p>This vignette shows many of the features of the package, some features have room for improvement, others are not fully described, and the reader will need to browse the documentation. Hopefully it is a good starting point for using the package.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#node-1-data-wrangling">NODE 1: Data wrangling</a><ul class="nav nav-pills nav-stacked">
<li><a href="#convert-raw-to-mzxml">Convert RAW to mzXML</a></li>
      <li><a href="#input">Input</a></li>
      <li><a href="#code-to-run">Code to run</a></li>
      </ul>
</li>
      <li>
<a href="#node-2-append-metadata">NODE 2: Append metadata</a><ul class="nav nav-pills nav-stacked">
<li><a href="#input-parameters">Input parameters</a></li>
      <li><a href="#code-to-run-1">Code to run</a></li>
      </ul>
</li>
      <li><a href="#node-3-total-ion-chromatogram">NODE 3: Total ion chromatogram</a></li>
      <li>
<a href="#node-4-filtering">NODE 4: Filtering</a><ul class="nav nav-pills nav-stacked">
<li><a href="#filter-by-retention-time-mz">Filter by retention time / m/z</a></li>
      <li><a href="#input-1">Input</a></li>
      <li><a href="#code-to-run-2">Code to run</a></li>
      </ul>
</li>
      <li>
<a href="#node-5-data-preprocessing---xcms">NODE 5: Data Preprocessing - XCMS</a><ul class="nav nav-pills nav-stacked">
<li><a href="#checking-xxx-at-5-8-min-and-mz">Checking xxx at 5.8 min and m/z</a></li>
      <li><a href="#code-to-run-3">Code to run</a></li>
      </ul>
</li>
      <li>
<a href="#node-5-optimization-of-parameters">NODE 5: Optimization of parameters</a><ul class="nav nav-pills nav-stacked">
<li><a href="#optimization-of-peak-detection-parameters-for-xcms">Optimization of <strong>Peak Detection</strong> parameters for xcms</a></li>
      <li><a href="#input-2">Input</a></li>
      <li><a href="#code-to-run-4">Code to run</a></li>
      </ul>
</li>
      <li><a href="#final-thoughts">Final thoughts</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Luis Fernandez, Francisco Madrid-Gambin, Sergio Oller, Ivan Montoliu Roura.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
