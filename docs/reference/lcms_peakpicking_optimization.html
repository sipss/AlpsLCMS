<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Peak picking optimization — lcms_peakpicking_optimization • NIHSlcms</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Peak picking optimization — lcms_peakpicking_optimization" />
<meta property="og:description" content="The function optimize parameters considering a set of samples
for the peak picking algorithm using the IPO Package.
This includes Peak Detection (‘Centwave’ and ‘Matched Filter’),
Retention Time Correction (‘obiwarp’) and Peak Correspondence
(‘Density’)." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">NIHSlcms</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Peak picking optimization</h1>
    
    <div class="hidden name"><code>lcms_peakpicking_optimization.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function optimize parameters considering a set of samples
for the peak picking algorithm using the IPO Package.
This includes Peak Detection (‘Centwave’ and ‘Matched Filter’),
Retention Time Correction (‘obiwarp’) and Peak Correspondence
(‘Density’).</p>
    </div>

    <pre class="usage"><span class='fu'>lcms_peakpicking_optimization</span>(<span class='no'>lcms_dataset</span>, <span class='no'>peakpickingParameters</span>,
  <span class='kw'>nSlaves</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='no'>opt_path</span>, <span class='kw'>subdir</span> <span class='kw'>=</span> <span class='st'>"plot_ipo"</span>, <span class='kw'>plots</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>lcms_dataset</th>
      <td><p>A <a href='lcms_dataset_family.html'>lcms_dataset_family</a> object</p></td>
    </tr>
    <tr>
      <th>peakpickingParameters</th>
      <td><p>Parameters for peak picking</p></td>
    </tr>
    <tr>
      <th>nSlaves</th>
      <td><p>Number of slaves the optimization process should spawn.</p></td>
    </tr>
    <tr>
      <th>opt_path</th>
      <td><p>Path where optimization samples are saved. Id subdir is</p></td>
    </tr>
    <tr>
      <th>subdir</th>
      <td><p>Folder where surface plots are save. If NULL they are displayed by the graphical device.</p></td>
    </tr>
    <tr>
      <th>plots</th>
      <td><p>Defines if plots should be generated (TRUE) or not (FALSE) in a subfolder called "plot_ipo" (default).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A peak picking list with the best setting</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other optimization functions: <code><a href='lcms_default_peakpicking_params.html'>lcms_default_peakpicking_params</a></code>,
  <code><a href='lcms_default_retcorgroup_params.html'>lcms_default_retcorgroup_params</a></code>,
  <code><a href='lcms_write_opt_params.html'>lcms_write_opt_params</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>opt_path</span> <span class='kw'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"extdata"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"NIHSlcms"</span>)
<span class='no'>file_name</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"extdata"</span>, <span class='st'>"lcms_dataset_rt_pos_rs.rds"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"NIHSlcms"</span>)
<span class='no'>lcms_dataset</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='lcms_dataset_load.html'>lcms_dataset_load</a></span>(<span class='no'>file_name</span>)
<span class='no'>default_peakpicking_params</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='lcms_default_peakpicking_params.html'>lcms_default_peakpicking_params</a></span>(<span class='kw'>optimize</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='no'>resultPeakpicking</span> <span class='kw'>&lt;-</span> <span class='fu'>lcms_peakpicking_optimization</span>(<span class='no'>lcms_dataset</span>,
                                                   <span class='no'>default_peakpicking_params</span>,
                                                   <span class='kw'>opt_path</span> <span class='kw'>=</span> <span class='no'>opt_path</span>,
                                                   <span class='kw'>subdir</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</div><div class='output co'>#&gt; Be careful if you run twice the function using the same output directory. 
#&gt; The algorithm won't rewrite files that are already in the directory, but will store new samples in it. 
#&gt; Samples used for optimization:
#&gt; 	1.mzXML 2.mzXML 3.mzXML 4.mzXML
#&gt; Saving filtered chromatogram... 
#&gt; Performing retention time and grouping
#&gt;         parameter optimization. This will take some time... </div><div class='img'><img src='lcms_peakpicking_optimization-1.png' alt='' width='700' height='433' /></div><div class='img'><img src='lcms_peakpicking_optimization-2.png' alt='' width='700' height='433' /></div><div class='img'><img src='lcms_peakpicking_optimization-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>resultPeakpicking</span>)</div><div class='output co'>#&gt; [[1]]
#&gt; [[1]]$params
#&gt; [[1]]$params$to_optimize
#&gt; [[1]]$params$to_optimize$min_peakwidth
#&gt; [1] 10 30
#&gt; 
#&gt; [[1]]$params$to_optimize$max_peakwidth
#&gt; [1]  35 120
#&gt; 
#&gt; [[1]]$params$to_optimize$ppm
#&gt; [1] 17 32
#&gt; 
#&gt; [[1]]$params$to_optimize$mzdiff
#&gt; [1] -0.001  0.010
#&gt; 
#&gt; 
#&gt; [[1]]$params$no_optimization
#&gt; [[1]]$params$no_optimization$snthresh
#&gt; [1] 10
#&gt; 
#&gt; [[1]]$params$no_optimization$noise
#&gt; [1] 5000
#&gt; 
#&gt; [[1]]$params$no_optimization$prefilter
#&gt; [1] 3
#&gt; 
#&gt; [[1]]$params$no_optimization$value_of_prefilter
#&gt; [1] 100
#&gt; 
#&gt; [[1]]$params$no_optimization$mzCenterFun
#&gt; [1] "wMean"
#&gt; 
#&gt; [[1]]$params$no_optimization$integrate
#&gt; [1] 1
#&gt; 
#&gt; [[1]]$params$no_optimization$fitgauss
#&gt; [1] FALSE
#&gt; 
#&gt; [[1]]$params$no_optimization$verbose.columns
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; 
#&gt; [[1]]$design
#&gt;    run.order std.order min_peakwidth max_peakwidth  ppm  mzdiff Block
#&gt; 1          1         1            10          35.0 17.0 -0.0010     1
#&gt; 2          2         2            30          35.0 17.0 -0.0010     1
#&gt; 3          3         3            10         120.0 17.0 -0.0010     1
#&gt; 4          4         4            30         120.0 17.0 -0.0010     1
#&gt; 5          5         5            10          35.0 32.0 -0.0010     1
#&gt; 6          6         6            30          35.0 32.0 -0.0010     1
#&gt; 7          7         7            10         120.0 32.0 -0.0010     1
#&gt; 8          8         8            30         120.0 32.0 -0.0010     1
#&gt; 9          9         9            10          35.0 17.0  0.0100     1
#&gt; 10        10        10            30          35.0 17.0  0.0100     1
#&gt; 11        11        11            10         120.0 17.0  0.0100     1
#&gt; 12        12        12            30         120.0 17.0  0.0100     1
#&gt; 13        13        13            10          35.0 32.0  0.0100     1
#&gt; 14        14        14            30          35.0 32.0  0.0100     1
#&gt; 15        15        15            10         120.0 32.0  0.0100     1
#&gt; 16        16        16            30         120.0 32.0  0.0100     1
#&gt; 17        17        17            20          77.5 24.5  0.0045     1
#&gt; 18         1         1            10          77.5 24.5  0.0045     2
#&gt; 19         2         2            30          77.5 24.5  0.0045     2
#&gt; 20         3         3            20          35.0 24.5  0.0045     2
#&gt; 21         4         4            20         120.0 24.5  0.0045     2
#&gt; 22         5         5            20          77.5 17.0  0.0045     2
#&gt; 23         6         6            20          77.5 32.0  0.0045     2
#&gt; 24         7         7            20          77.5 24.5 -0.0010     2
#&gt; 25         8         8            20          77.5 24.5  0.0100     2
#&gt; 26         9         9            20          77.5 24.5  0.0045     2
#&gt; 
#&gt; Data are stored in coded form using these coding formulas ...
#&gt; x1 ~ (min_peakwidth - 20)/10
#&gt; x2 ~ (max_peakwidth - 77.5)/42.5
#&gt; x3 ~ (ppm - 24.5)/7.5
#&gt; x4 ~ (mzdiff - 0.0045)/0.0055
#&gt; 
#&gt; [[1]]$response
#&gt;       exp num_peaks notLLOQP num_C13        PPS
#&gt;  [1,]   1       542      346      34  3.3410405
#&gt;  [2,]   2       101       50       0  0.0000000
#&gt;  [3,]   3       755      520      58  6.4692308
#&gt;  [4,]   4       223      155      12  0.9290323
#&gt;  [5,]   5       559      369      52  7.3279133
#&gt;  [6,]   6        64       39       0  0.0000000
#&gt;  [7,]   7       897      633      90 12.7962085
#&gt;  [8,]   8       264      204      20  1.9607843
#&gt;  [9,]   9       445      291      34  3.9725086
#&gt; [10,]  10        87       47       0  0.0000000
#&gt; [11,]  11       620      422      56  7.4312796
#&gt; [12,]  12       206      146      12  0.9863014
#&gt; [13,]  13       548      360      52  7.5111111
#&gt; [14,]  14        64       39       0  0.0000000
#&gt; [15,]  15       858      572      90 14.1608392
#&gt; [16,]  16       264      204      20  1.9607843
#&gt; [17,]  17       366      262      26  2.5801527
#&gt; [18,]  18       634      407      64 10.0638821
#&gt; [19,]  19       180      143      12  1.0069930
#&gt; [20,]  20       270      185      20  2.1621622
#&gt; [21,]  21       426      324      26  2.0864198
#&gt; [22,]  22       322      237      16  1.0801688
#&gt; [23,]  23       428      318      34  3.6352201
#&gt; [24,]  24       382      276      26  2.4492754
#&gt; [25,]  25       366      262      26  2.5801527
#&gt; [26,]  26       366      262      26  2.5801527
#&gt; 
#&gt; [[1]]$model
#&gt; 
#&gt; Call:
#&gt; rsm(formula = resp ~ SO(x1, x2, x3, x4), data = design)
#&gt; 
#&gt; Coefficients:
#&gt;              (Intercept)      FO(x1, x2, x3, x4)x1      FO(x1, x2, x3, x4)x2  
#&gt;                 2.691865                 -3.679451                  1.359230  
#&gt;     FO(x1, x2, x3, x4)x3      FO(x1, x2, x3, x4)x4  TWI(x1, x2, x3, x4)x1:x2  
#&gt;                 1.396850                  0.184972                 -0.804255  
#&gt; TWI(x1, x2, x3, x4)x1:x3  TWI(x1, x2, x3, x4)x1:x4  TWI(x1, x2, x3, x4)x2:x3  
#&gt;                -1.160986                 -0.192755                  0.471081  
#&gt; TWI(x1, x2, x3, x4)x2:x4  TWI(x1, x2, x3, x4)x3:x4    PQ(x1, x2, x3, x4)x1^2  
#&gt;                 0.098080                 -0.006435                  2.806336  
#&gt;   PQ(x1, x2, x3, x4)x2^2    PQ(x1, x2, x3, x4)x3^2    PQ(x1, x2, x3, x4)x4^2  
#&gt;                -0.604811                 -0.371407                 -0.214388  
#&gt; 
#&gt; 
#&gt; [[1]]$max_settings
#&gt;      response x1 x2 x3 x4
#&gt; [1,] 13.64882 -1  1  1  1
#&gt; 
#&gt; [[1]]$xset
#&gt; An "xcmsSet" object with 4 samples
#&gt; 
#&gt; Time range: 59.9-1381 seconds (1-23 minutes)
#&gt; Mass range: 85.0288-726.3861 m/z
#&gt; Peaks: 858 (about 214 per sample)
#&gt; Peak Groups: 0 
#&gt; Sample classes: extdata 
#&gt; 
#&gt; Feature detection:
#&gt;  o Peak picking performed on MS1.
#&gt; Profile settings: method = bin
#&gt;                   step = 0.1
#&gt; 
#&gt; Memory usage: 0.258 MB
#&gt; 
#&gt; [[1]]$PPS
#&gt;     ExpId    #peaks    #NonRP       #RP       PPS 
#&gt;   0.00000 858.00000 572.00000  90.00000  14.16084 
#&gt; 
#&gt; 
#&gt; [[2]]
#&gt; [[2]]$params
#&gt; [[2]]$params$to_optimize
#&gt; [[2]]$params$to_optimize$min_peakwidth
#&gt; [1]  3 23
#&gt; 
#&gt; [[2]]$params$to_optimize$max_peakwidth
#&gt; [1]  77.5 162.5
#&gt; 
#&gt; [[2]]$params$to_optimize$ppm
#&gt; [1] 24.5 39.5
#&gt; 
#&gt; [[2]]$params$to_optimize$mzdiff
#&gt; [1] 0.0045 0.0155
#&gt; 
#&gt; 
#&gt; [[2]]$params$no_optimization
#&gt; [[2]]$params$no_optimization$snthresh
#&gt; [1] 10
#&gt; 
#&gt; [[2]]$params$no_optimization$noise
#&gt; [1] 5000
#&gt; 
#&gt; [[2]]$params$no_optimization$prefilter
#&gt; [1] 3
#&gt; 
#&gt; [[2]]$params$no_optimization$value_of_prefilter
#&gt; [1] 100
#&gt; 
#&gt; [[2]]$params$no_optimization$mzCenterFun
#&gt; [1] "wMean"
#&gt; 
#&gt; [[2]]$params$no_optimization$integrate
#&gt; [1] 1
#&gt; 
#&gt; [[2]]$params$no_optimization$fitgauss
#&gt; [1] FALSE
#&gt; 
#&gt; [[2]]$params$no_optimization$verbose.columns
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; 
#&gt; [[2]]$design
#&gt;    run.order std.order min_peakwidth max_peakwidth  ppm mzdiff Block
#&gt; 1          1         1             3          77.5 24.5 0.0045     1
#&gt; 2          2         2            23          77.5 24.5 0.0045     1
#&gt; 3          3         3             3         162.5 24.5 0.0045     1
#&gt; 4          4         4            23         162.5 24.5 0.0045     1
#&gt; 5          5         5             3          77.5 39.5 0.0045     1
#&gt; 6          6         6            23          77.5 39.5 0.0045     1
#&gt; 7          7         7             3         162.5 39.5 0.0045     1
#&gt; 8          8         8            23         162.5 39.5 0.0045     1
#&gt; 9          9         9             3          77.5 24.5 0.0155     1
#&gt; 10        10        10            23          77.5 24.5 0.0155     1
#&gt; 11        11        11             3         162.5 24.5 0.0155     1
#&gt; 12        12        12            23         162.5 24.5 0.0155     1
#&gt; 13        13        13             3          77.5 39.5 0.0155     1
#&gt; 14        14        14            23          77.5 39.5 0.0155     1
#&gt; 15        15        15             3         162.5 39.5 0.0155     1
#&gt; 16        16        16            23         162.5 39.5 0.0155     1
#&gt; 17        17        17            13         120.0 32.0 0.0100     1
#&gt; 18         1         1             3         120.0 32.0 0.0100     2
#&gt; 19         2         2            23         120.0 32.0 0.0100     2
#&gt; 20         3         3            13          77.5 32.0 0.0100     2
#&gt; 21         4         4            13         162.5 32.0 0.0100     2
#&gt; 22         5         5            13         120.0 24.5 0.0100     2
#&gt; 23         6         6            13         120.0 39.5 0.0100     2
#&gt; 24         7         7            13         120.0 32.0 0.0045     2
#&gt; 25         8         8            13         120.0 32.0 0.0155     2
#&gt; 26         9         9            13         120.0 32.0 0.0100     2
#&gt; 
#&gt; Data are stored in coded form using these coding formulas ...
#&gt; x1 ~ (min_peakwidth - 13)/10
#&gt; x2 ~ (max_peakwidth - 120)/42.5
#&gt; x3 ~ (ppm - 32)/7.5
#&gt; x4 ~ (mzdiff - 0.01)/0.0055
#&gt; 
#&gt; [[2]]$response
#&gt;       exp num_peaks notLLOQP num_C13        PPS
#&gt;  [1,]   1       527      394      38  3.6649746
#&gt;  [2,]   2       279      229      14  0.8558952
#&gt;  [3,]   3       641      476      48  4.8403361
#&gt;  [4,]   4       367      296      16  0.8648649
#&gt;  [5,]   5       666      534      36  2.4269663
#&gt;  [6,]   6       348      279      28  2.8100358
#&gt;  [7,]   7       818      638      42  2.7648903
#&gt;  [8,]   8       439      345      38  4.1855072
#&gt;  [9,]   9       524      393      38  3.6743003
#&gt; [10,]  10       279      229      14  0.8558952
#&gt; [11,]  11       637      473      48  4.8710359
#&gt; [12,]  12       367      296      16  0.8648649
#&gt; [13,]  13       666      534      36  2.4269663
#&gt; [14,]  14       348      279      28  2.8100358
#&gt; [15,]  15       816      637      42  2.7692308
#&gt; [16,]  16       439      345      38  4.1855072
#&gt; [17,]  17       736      506      82 13.2885375
#&gt; [18,]  18       684      521      44  3.7159309
#&gt; [19,]  19       378      297      32  3.4478114
#&gt; [20,]  20       624      424      70 11.5566038
#&gt; [21,]  21       785      535      90 15.1401869
#&gt; [22,]  22       625      433      58  7.7690531
#&gt; [23,]  23       811      556      84 12.6906475
#&gt; [24,]  24       736      506      82 13.2885375
#&gt; [25,]  25       736      506      82 13.2885375
#&gt; [26,]  26       736      506      82 13.2885375
#&gt; 
#&gt; [[2]]$model
#&gt; 
#&gt; Call:
#&gt; rsm(formula = resp ~ SO(x1, x2, x3, x4), data = design)
#&gt; 
#&gt; Coefficients:
#&gt;              (Intercept)      FO(x1, x2, x3, x4)x1      FO(x1, x2, x3, x4)x2  
#&gt;                12.780786                 -0.570790                  0.522486  
#&gt;     FO(x1, x2, x3, x4)x3      FO(x1, x2, x3, x4)x4  TWI(x1, x2, x3, x4)x1:x2  
#&gt;                 0.489365                  0.002465                 -0.017713  
#&gt; TWI(x1, x2, x3, x4)x1:x3  TWI(x1, x2, x3, x4)x1:x4  TWI(x1, x2, x3, x4)x2:x3  
#&gt;                 1.075760                 -0.002773                  0.065068  
#&gt; TWI(x1, x2, x3, x4)x2:x4  TWI(x1, x2, x3, x4)x3:x4    PQ(x1, x2, x3, x4)x1^2  
#&gt;                 0.001607                 -0.002230                 -9.029664  
#&gt;   PQ(x1, x2, x3, x4)x2^2    PQ(x1, x2, x3, x4)x3^2    PQ(x1, x2, x3, x4)x4^2  
#&gt;                 0.736860                 -2.381685                  0.677003  
#&gt; 
#&gt; 
#&gt; [[2]]$max_settings
#&gt;      response x1 x2  x3 x4
#&gt; [1,] 14.75261  0  1 0.1  1
#&gt; 
#&gt; [[2]]$xset
#&gt; An "xcmsSet" object with 4 samples
#&gt; 
#&gt; Time range: 63.9-1380.4 seconds (1.1-23 minutes)
#&gt; Mass range: 85.0288-706.7816 m/z
#&gt; Peaks: 791 (about 198 per sample)
#&gt; Peak Groups: 0 
#&gt; Sample classes: extdata 
#&gt; 
#&gt; Feature detection:
#&gt;  o Peak picking performed on MS1.
#&gt; Profile settings: method = bin
#&gt;                   step = 0.1
#&gt; 
#&gt; Memory usage: 0.252 MB
#&gt; 
#&gt; [[2]]$PPS
#&gt;     ExpId    #peaks    #NonRP       #RP       PPS 
#&gt;   0.00000 791.00000 541.00000  90.00000  14.97227 
#&gt; 
#&gt; 
#&gt; [[3]]
#&gt; [[3]]$params
#&gt; [[3]]$params$to_optimize
#&gt; [[3]]$params$to_optimize$min_peakwidth
#&gt; [1]  5 21
#&gt; 
#&gt; [[3]]$params$to_optimize$max_peakwidth
#&gt; [1] 120 205
#&gt; 
#&gt; [[3]]$params$to_optimize$ppm
#&gt; [1] 26.75 38.75
#&gt; 
#&gt; [[3]]$params$to_optimize$mzdiff
#&gt; [1] 0.010 0.021
#&gt; 
#&gt; 
#&gt; [[3]]$params$no_optimization
#&gt; [[3]]$params$no_optimization$snthresh
#&gt; [1] 10
#&gt; 
#&gt; [[3]]$params$no_optimization$noise
#&gt; [1] 5000
#&gt; 
#&gt; [[3]]$params$no_optimization$prefilter
#&gt; [1] 3
#&gt; 
#&gt; [[3]]$params$no_optimization$value_of_prefilter
#&gt; [1] 100
#&gt; 
#&gt; [[3]]$params$no_optimization$mzCenterFun
#&gt; [1] "wMean"
#&gt; 
#&gt; [[3]]$params$no_optimization$integrate
#&gt; [1] 1
#&gt; 
#&gt; [[3]]$params$no_optimization$fitgauss
#&gt; [1] FALSE
#&gt; 
#&gt; [[3]]$params$no_optimization$verbose.columns
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; 
#&gt; [[3]]$design
#&gt;    run.order std.order min_peakwidth max_peakwidth   ppm mzdiff Block
#&gt; 1          1         1             5         120.0 26.75 0.0100     1
#&gt; 2          2         2            21         120.0 26.75 0.0100     1
#&gt; 3          3         3             5         205.0 26.75 0.0100     1
#&gt; 4          4         4            21         205.0 26.75 0.0100     1
#&gt; 5          5         5             5         120.0 38.75 0.0100     1
#&gt; 6          6         6            21         120.0 38.75 0.0100     1
#&gt; 7          7         7             5         205.0 38.75 0.0100     1
#&gt; 8          8         8            21         205.0 38.75 0.0100     1
#&gt; 9          9         9             5         120.0 26.75 0.0210     1
#&gt; 10        10        10            21         120.0 26.75 0.0210     1
#&gt; 11        11        11             5         205.0 26.75 0.0210     1
#&gt; 12        12        12            21         205.0 26.75 0.0210     1
#&gt; 13        13        13             5         120.0 38.75 0.0210     1
#&gt; 14        14        14            21         120.0 38.75 0.0210     1
#&gt; 15        15        15             5         205.0 38.75 0.0210     1
#&gt; 16        16        16            21         205.0 38.75 0.0210     1
#&gt; 17        17        17            13         162.5 32.75 0.0155     1
#&gt; 18         1         1             5         162.5 32.75 0.0155     2
#&gt; 19         2         2            21         162.5 32.75 0.0155     2
#&gt; 20         3         3            13         120.0 32.75 0.0155     2
#&gt; 21         4         4            13         205.0 32.75 0.0155     2
#&gt; 22         5         5            13         162.5 26.75 0.0155     2
#&gt; 23         6         6            13         162.5 38.75 0.0155     2
#&gt; 24         7         7            13         162.5 32.75 0.0100     2
#&gt; 25         8         8            13         162.5 32.75 0.0210     2
#&gt; 26         9         9            13         162.5 32.75 0.0155     2
#&gt; 
#&gt; Data are stored in coded form using these coding formulas ...
#&gt; x1 ~ (min_peakwidth - 13)/8
#&gt; x2 ~ (max_peakwidth - 162.5)/42.5
#&gt; x3 ~ (ppm - 32.75)/6
#&gt; x4 ~ (mzdiff - 0.0155)/0.0055
#&gt; 
#&gt; [[3]]$response
#&gt;       exp num_peaks notLLOQP num_C13       PPS
#&gt;  [1,]   1       801      560      60  6.428571
#&gt;  [2,]   2       406      305      31  3.150820
#&gt;  [3,]   3       967      691      68  6.691751
#&gt;  [4,]   4       479      346      36  3.745665
#&gt;  [5,]   5       942      713      56  4.398317
#&gt;  [6,]   6       472      331      51  7.858006
#&gt;  [7,]   7      1116      833      72  6.223289
#&gt;  [8,]   8       553      392      54  7.438776
#&gt;  [9,]   9       801      560      60  6.428571
#&gt; [10,]  10       405      304      31  3.161184
#&gt; [11,]  11       964      689      68  6.711176
#&gt; [12,]  12       477      344      36  3.767442
#&gt; [13,]  13       938      712      58  4.724719
#&gt; [14,]  14       471      330      51  7.881818
#&gt; [15,]  15      1108      823      74  6.653706
#&gt; [16,]  16       549      389      54  7.496144
#&gt; [17,]  17       791      541      90 14.972274
#&gt; [18,]  18       960      703      64  5.826458
#&gt; [19,]  19       498      356      51  7.306180
#&gt; [20,]  20       742      509      82 13.210216
#&gt; [21,]  21       838      584      90 13.869863
#&gt; [22,]  22       709      485      80 13.195876
#&gt; [23,]  23       851      587      92 14.419080
#&gt; [24,]  24       791      541      90 14.972274
#&gt; [25,]  25       791      541      90 14.972274
#&gt; [26,]  26       791      541      90 14.972274
#&gt; 
#&gt; [[3]]$model
#&gt; 
#&gt; Call:
#&gt; rsm(formula = resp ~ SO(x1, x2, x3, x4), data = design)
#&gt; 
#&gt; Coefficients:
#&gt;              (Intercept)      FO(x1, x2, x3, x4)x1      FO(x1, x2, x3, x4)x2  
#&gt;                 14.55440                  -0.12670                   0.29753  
#&gt;     FO(x1, x2, x3, x4)x3      FO(x1, x2, x3, x4)x4  TWI(x1, x2, x3, x4)x1:x2  
#&gt;                  0.76738                   0.04942                  -0.24397  
#&gt; TWI(x1, x2, x3, x4)x1:x3  TWI(x1, x2, x3, x4)x1:x4  TWI(x1, x2, x3, x4)x2:x3  
#&gt;                  1.31935                  -0.04143                   0.07514  
#&gt; TWI(x1, x2, x3, x4)x2:x4  TWI(x1, x2, x3, x4)x3:x4    PQ(x1, x2, x3, x4)x1^2  
#&gt;                  0.01053                   0.04915                  -7.84879  
#&gt;   PQ(x1, x2, x3, x4)x2^2    PQ(x1, x2, x3, x4)x3^2    PQ(x1, x2, x3, x4)x4^2  
#&gt;                 -0.87507                  -0.60763                   0.55717  
#&gt; 
#&gt; 
#&gt; [[3]]$max_settings
#&gt;      response x1  x2  x3 x4
#&gt; [1,] 15.47195  0 0.2 0.7  1
#&gt; 
#&gt; [[3]]$xset
#&gt; An "xcmsSet" object with 4 samples
#&gt; 
#&gt; Time range: 63.9-1380.4 seconds (1.1-23 minutes)
#&gt; Mass range: 85.0288-706.7816 m/z
#&gt; Peaks: 834 (about 208 per sample)
#&gt; Peak Groups: 0 
#&gt; Sample classes: extdata 
#&gt; 
#&gt; Feature detection:
#&gt;  o Peak picking performed on MS1.
#&gt; Profile settings: method = bin
#&gt;                   step = 0.1
#&gt; 
#&gt; Memory usage: 0.256 MB
#&gt; 
#&gt; [[3]]$PPS
#&gt;     ExpId    #peaks    #NonRP       #RP       PPS 
#&gt;   0.00000 834.00000 575.00000  90.00000  14.08696 
#&gt; 
#&gt; 
#&gt; $best_settings
#&gt; $best_settings$parameters
#&gt; $best_settings$parameters$min_peakwidth
#&gt; [1] 13
#&gt; 
#&gt; $best_settings$parameters$max_peakwidth
#&gt; [1] 171
#&gt; 
#&gt; $best_settings$parameters$ppm
#&gt; [1] 36.95
#&gt; 
#&gt; $best_settings$parameters$mzdiff
#&gt; [1] 0.021
#&gt; 
#&gt; $best_settings$parameters$snthresh
#&gt; [1] 10
#&gt; 
#&gt; $best_settings$parameters$noise
#&gt; [1] 5000
#&gt; 
#&gt; $best_settings$parameters$prefilter
#&gt; [1] 3
#&gt; 
#&gt; $best_settings$parameters$value_of_prefilter
#&gt; [1] 100
#&gt; 
#&gt; $best_settings$parameters$mzCenterFun
#&gt; [1] "wMean"
#&gt; 
#&gt; $best_settings$parameters$integrate
#&gt; [1] 1
#&gt; 
#&gt; $best_settings$parameters$fitgauss
#&gt; [1] FALSE
#&gt; 
#&gt; $best_settings$parameters$verbose.columns
#&gt; [1] FALSE
#&gt; 
#&gt; 
#&gt; $best_settings$xset
#&gt; An "xcmsSet" object with 4 samples
#&gt; 
#&gt; Time range: 63.9-1380.4 seconds (1.1-23 minutes)
#&gt; Mass range: 85.0288-706.7816 m/z
#&gt; Peaks: 834 (about 208 per sample)
#&gt; Peak Groups: 0 
#&gt; Sample classes: extdata 
#&gt; 
#&gt; Feature detection:
#&gt;  o Peak picking performed on MS1.
#&gt; Profile settings: method = bin
#&gt;                   step = 0.1
#&gt; 
#&gt; Memory usage: 0.256 MB
#&gt; 
#&gt; $best_settings$result
#&gt;     ExpId    #peaks    #NonRP       #RP       PPS 
#&gt;   0.00000 834.00000 575.00000  90.00000  14.08696 
#&gt; 
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Luis Fernandez, Francisco Madrid-Gambin, Sergio Oller, Ivan Montoliu Roura.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


