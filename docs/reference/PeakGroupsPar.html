<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Peak density parameters — PeakGroupsPar • AlpsLCMS</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Peak density parameters — PeakGroupsPar" />
<meta property="og:description" content="The method creates a template with the parameters for alignment.
Extracted from the function xcms::PeakGroupsParam." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">AlpsLCMS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9008</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/introduction-to-alpslcms.html">Introduction to AlpsLCMS</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Peak density parameters</h1>
    
    <div class="hidden name"><code>PeakGroupsPar.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The method creates a template with the parameters for <strong>alignment</strong>.
Extracted from the function <code><a href='https://rdrr.io/pkg/xcms/man/adjustRtime-peakGroups.html'>xcms::PeakGroupsParam</a></code>.</p>
    </div>

    <pre class="usage"><span class='fu'>PeakGroupsPar</span>(<span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>...</th>
      <td><p>Arguments passed on to <code><a href='https://rdrr.io/pkg/xcms/man/adjustRtime-peakGroups.html'>xcms::PeakGroupsParam</a></code></p><dl class='dl-horizontal'>
    <dt><code>minFraction</code></dt><dd><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> between 0 and 1 defining the minimum
required fraction of samples in which peaks for the peak group were
identified. Peak groups passing this criteria will aligned across
samples and retention times of individual spectra will be adjusted
based on this alignment. For <code>minFraction = 1</code> the peak group
has to contain peaks in all samples of the experiment. Note that if
<code>subset</code> is provided, the specified fraction is relative to the
defined subset of samples and not to the total number of samples within
the experiment (i.e. a peak has to be present in the specified
proportion of subset samples).</p></dd>
    <dt><code>extraPeaks</code></dt><dd><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> defining the maximal number of
additional peaks for all samples to be assigned to a peak group (i.e.
feature) for retention time correction. For a data set with 6 samples,
<code>extraPeaks = 1</code> uses all peak groups with a total peak count
<code>&lt;= 6 + 1</code>. The total peak count is the total number of peaks being
assigned to a peak group and considers also multiple peaks within a
sample being assigned to the group.</p></dd>
    <dt><code>smooth</code></dt><dd><p>character defining the function to be used, to interpolate
corrected retention times for all peak groups. Either <code>"loess"</code> or
<code>"linear"</code>.</p></dd>
    <dt><code>span</code></dt><dd><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> defining the degree of smoothing (if
<code>smooth = "loess"</code>). This parameter is passed to the internal call
to <code><a href='https://rdrr.io/r/stats/loess.html'>loess</a></code>.</p></dd>
    <dt><code>family</code></dt><dd><p>character defining the method to be used for loess smoothing.
Allowed values are <code>"gaussian"</code> and <code>"symmetric"</code>.See
<code><a href='https://rdrr.io/r/stats/loess.html'>loess</a></code> for more information.</p></dd>
    <dt><code>peakGroupsMatrix</code></dt><dd><p>optional <code>matrix</code> of (raw) retention times for
the peak groups on which the alignment should be performed. Each column
represents a sample, each row a feature/peak group. Such a matrix is
for example returned by the <code><a href='https://rdrr.io/pkg/xcms/man/adjustRtime-peakGroups.html'>adjustRtimePeakGroups</a></code> method.</p></dd>
    <dt><code>subset</code></dt><dd><p><code>integer</code> with the indices of samples within the
experiment on which the alignment models should be estimated. Samples
not part of the subset are adjusted based on the closest subset sample.
See description above for more details.</p></dd>
    <dt><code>subsetAdjust</code></dt><dd><p><code>character</code> specifying the method with which
non-subset samples should be adjusted. Supported options are
<code>"previous"</code> and <code>"average"</code> (default). See description above
for more information.</p></dd>
  
</dl></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>PeakGroupsParam S4 object</p>
    <h2 class="hasAnchor" id="slots"><a class="anchor" href="#slots"></a>Slots</h2>

    


<dl class='dl-horizontal'>
<dt><code>.__classVersion__,minFraction,extraPeaks,smooth,span,family,peakGroupsMatrix,subset,subsetAdjust</code></dt><dd><p>See corresponding parameter above. <code>.__classVersion__</code> stores
the version from the class. Slots values should exclusively be accessed
<em>via</em> the corresponding getter and setter methods listed above.</p></dd>

</dl>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Colin A. Smith, Elizabeth J. Want, Grace O'Maille, Ruben Abagyan and
Gary Siuzdak. "XCMS: Processing Mass Spectrometry Data for Metabolite
Profiling Using Nonlinear Peak Alignment, Matching, and Identification"
<em>Anal. Chem.</em> 2006, 78:779-787.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>The <code><a href='https://rdrr.io/pkg/xcms/man/do_adjustRtime_peakGroups.html'>do_adjustRtime_peakGroups</a></code> core
    API function and <code><a href='https://rdrr.io/pkg/xcms/man/retcor.peakgroups-methods.html'>retcor.peakgroups</a></code> for the old user
    interface.
    <code><a href='https://rdrr.io/pkg/xcms/man/plotAdjustedRtime.html'>plotAdjustedRtime</a></code> for visualization of alignment results.</p>
<p><code><a href='https://rdrr.io/pkg/xcms/man/XCMSnExp-class.html'>XCMSnExp</a></code> for the object containing the results of
    the alignment.</p>
<p>Other retention time correction methods: <code><a href='https://rdrr.io/pkg/xcms/man/adjustRtime-obiwarp.html'>adjustRtime-obiwarp</a></code>,
  <code><a href='https://rdrr.io/pkg/xcms/man/adjustRtime.html'>adjustRtime</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>##############################</span>
<span class='co'>## Chromatographic peak detection and grouping.</span>
<span class='co'>##</span>
<span class='co'>## Below we perform first a peak detection (using the matchedFilter</span>
<span class='co'>## method) on some of the test files from the faahKO package followed by</span>
<span class='co'>## a peak grouping.</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>faahKO</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: xcms</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: Biobase</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: BiocGenerics</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: parallel</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: 'BiocGenerics'</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from 'package:parallel':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,</span>
#&gt; <span class='message'>    clusterExport, clusterMap, parApply, parCapply, parLapply,</span>
#&gt; <span class='message'>    parLapplyLB, parRapply, parSapply, parSapplyLB</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from 'package:stats':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    IQR, mad, sd, var, xtabs</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from 'package:base':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    anyDuplicated, append, as.data.frame, basename, cbind, colnames,</span>
#&gt; <span class='message'>    dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,</span>
#&gt; <span class='message'>    grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,</span>
#&gt; <span class='message'>    order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,</span>
#&gt; <span class='message'>    rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,</span>
#&gt; <span class='message'>    union, unique, unsplit, which, which.max, which.min</span></div><div class='output co'>#&gt; <span class='message'>Welcome to Bioconductor</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    Vignettes contain introductory material; view with</span>
#&gt; <span class='message'>    'browseVignettes()'. To cite Bioconductor, see</span>
#&gt; <span class='message'>    'citation("Biobase")', and for packages 'citation("pkgname")'.</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: BiocParallel</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: MSnbase</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: mzR</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: Rcpp</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: S4Vectors</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: stats4</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: 'S4Vectors'</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from 'package:base':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    expand.grid</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: ProtGenerics</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: 'ProtGenerics'</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from 'package:mzR':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    analyzer, tolerance</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from 'package:stats':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    smooth</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>This is MSnbase version 2.10.1 </span>
#&gt; <span class='message'>  Visit https://lgatto.github.io/MSnbase/ to get started.</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: 'MSnbase'</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from 'package:ProtGenerics':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    acquisitionNum, analyser, analyserDetails, analyzerDetails,</span>
#&gt; <span class='message'>    centroided, centroided&lt;-, collisionEnergy, detectorType, expemail,</span>
#&gt; <span class='message'>    exptitle, filterAcquisitionNum, filterEmptySpectra,</span>
#&gt; <span class='message'>    filterIsolationWindow, filterMsLevel, filterMz, filterPolarity,</span>
#&gt; <span class='message'>    filterPrecursorMz, filterPrecursorScan, filterRt,</span>
#&gt; <span class='message'>    instrumentCustomisations, instrumentManufacturer, instrumentModel,</span>
#&gt; <span class='message'>    ionCount, ionSource, ionSourceDetails, isolationWindowLowerMz,</span>
#&gt; <span class='message'>    isolationWindowUpperMz, msInfo, msLevel, polarity, precScanNum,</span>
#&gt; <span class='message'>    precursorCharge, precursorIntensity, precursorMz, processingData,</span>
#&gt; <span class='message'>    productMz, scanIndex, smooth, smoothed, smoothed&lt;-</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from 'package:stats':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    smooth</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from 'package:base':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    trimws</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>This is xcms version 3.6.2 </span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: 'xcms'</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from 'package:ProtGenerics':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    peaks&lt;-, polarity&lt;-</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from 'package:stats':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    sigma</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>xcms</span>)
<span class='no'>fls</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>dir</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"cdf/KO"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"faahKO"</span>), <span class='kw'>recursive</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
           <span class='kw'>full.names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='co'>## Reading 2 of the KO samples</span>
<span class='no'>raw_data</span> <span class='kw'>&lt;-</span> <span class='fu'>readMSData</span>(<span class='no'>fls</span>[<span class='fl'>1</span>:<span class='fl'>2</span>], <span class='kw'>mode</span> <span class='kw'>=</span> <span class='st'>"onDisk"</span>)</div><div class='output co'>#&gt; <span class='message'>Polarity can not be extracted from netCDF files, please set manually the polarity with the 'polarity' method.</span></div><div class='input'>
<span class='co'>## Perform the peak detection using the matchedFilter method.</span>
<span class='no'>mfp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/xcms/man/findChromPeaks-matchedFilter.html'>MatchedFilterParam</a></span>(<span class='kw'>snthresh</span> <span class='kw'>=</span> <span class='fl'>20</span>, <span class='kw'>binSize</span> <span class='kw'>=</span> <span class='fl'>1</span>)
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/xcms/man/chromatographic-peak-detection.html'>findChromPeaks</a></span>(<span class='no'>raw_data</span>, <span class='kw'>param</span> <span class='kw'>=</span> <span class='no'>mfp</span>)</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: 'BiocGenerics'</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>The following objects are masked from 'package:parallel':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,</span>
#&gt; <span class='message'>    clusterExport, clusterMap, parApply, parCapply, parLapply,</span>
#&gt; <span class='message'>    parLapplyLB, parRapply, parSapply, parSapplyLB</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>The following objects are masked from 'package:stats':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    IQR, mad, sd, var, xtabs</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>The following objects are masked from 'package:base':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    anyDuplicated, append, as.data.frame, basename, cbind, colnames,</span>
#&gt; <span class='message'>    dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,</span>
#&gt; <span class='message'>    grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,</span>
#&gt; <span class='message'>    order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,</span>
#&gt; <span class='message'>    rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,</span>
#&gt; <span class='message'>    union, unique, unsplit, which, which.max, which.min</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>Welcome to Bioconductor</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    Vignettes contain introductory material; view with</span>
#&gt; <span class='message'>    'browseVignettes()'. To cite Bioconductor, see</span>
#&gt; <span class='message'>    'citation("Biobase")', and for packages 'citation("pkgname")'.</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: 'S4Vectors'</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>The following object is masked from 'package:base':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    expand.grid</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: 'ProtGenerics'</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>The following objects are masked from 'package:mzR':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    analyzer, tolerance</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>The following object is masked from 'package:stats':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    smooth</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>This is MSnbase version 2.10.1 </span>
#&gt; <span class='message'>  Visit https://lgatto.github.io/MSnbase/ to get started.</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: 'MSnbase'</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>The following objects are masked from 'package:ProtGenerics':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    acquisitionNum, analyser, analyserDetails, analyzerDetails,</span>
#&gt; <span class='message'>    centroided, centroided&lt;-, collisionEnergy, detectorType, expemail,</span>
#&gt; <span class='message'>    exptitle, filterAcquisitionNum, filterEmptySpectra,</span>
#&gt; <span class='message'>    filterIsolationWindow, filterMsLevel, filterMz, filterPolarity,</span>
#&gt; <span class='message'>    filterPrecursorMz, filterPrecursorScan, filterRt,</span>
#&gt; <span class='message'>    instrumentCustomisations, instrumentManufacturer, instrumentModel,</span>
#&gt; <span class='message'>    ionCount, ionSource, ionSourceDetails, isolationWindowLowerMz,</span>
#&gt; <span class='message'>    isolationWindowUpperMz, msInfo, msLevel, polarity, precScanNum,</span>
#&gt; <span class='message'>    precursorCharge, precursorIntensity, precursorMz, processingData,</span>
#&gt; <span class='message'>    productMz, scanIndex, smooth, smoothed, smoothed&lt;-</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>The following object is masked from 'package:stats':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    smooth</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>The following object is masked from 'package:base':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    trimws</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>This is xcms version 3.6.2 </span>
#&gt; <span class='message'></span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: 'xcms'</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>The following objects are masked from 'package:ProtGenerics':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    peaks&lt;-, polarity&lt;-</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>The following object is masked from 'package:stats':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    sigma</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: 'BiocGenerics'</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>The following objects are masked from 'package:parallel':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,</span>
#&gt; <span class='message'>    clusterExport, clusterMap, parApply, parCapply, parLapply,</span>
#&gt; <span class='message'>    parLapplyLB, parRapply, parSapply, parSapplyLB</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>The following objects are masked from 'package:stats':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    IQR, mad, sd, var, xtabs</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>The following objects are masked from 'package:base':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    anyDuplicated, append, as.data.frame, basename, cbind, colnames,</span>
#&gt; <span class='message'>    dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,</span>
#&gt; <span class='message'>    grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,</span>
#&gt; <span class='message'>    order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,</span>
#&gt; <span class='message'>    rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,</span>
#&gt; <span class='message'>    union, unique, unsplit, which, which.max, which.min</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>Welcome to Bioconductor</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    Vignettes contain introductory material; view with</span>
#&gt; <span class='message'>    'browseVignettes()'. To cite Bioconductor, see</span>
#&gt; <span class='message'>    'citation("Biobase")', and for packages 'citation("pkgname")'.</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: 'S4Vectors'</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>The following object is masked from 'package:base':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    expand.grid</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: 'ProtGenerics'</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>The following objects are masked from 'package:mzR':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    analyzer, tolerance</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>The following object is masked from 'package:stats':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    smooth</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>This is MSnbase version 2.10.1 </span>
#&gt; <span class='message'>  Visit https://lgatto.github.io/MSnbase/ to get started.</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: 'MSnbase'</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>The following objects are masked from 'package:ProtGenerics':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    acquisitionNum, analyser, analyserDetails, analyzerDetails,</span>
#&gt; <span class='message'>    centroided, centroided&lt;-, collisionEnergy, detectorType, expemail,</span>
#&gt; <span class='message'>    exptitle, filterAcquisitionNum, filterEmptySpectra,</span>
#&gt; <span class='message'>    filterIsolationWindow, filterMsLevel, filterMz, filterPolarity,</span>
#&gt; <span class='message'>    filterPrecursorMz, filterPrecursorScan, filterRt,</span>
#&gt; <span class='message'>    instrumentCustomisations, instrumentManufacturer, instrumentModel,</span>
#&gt; <span class='message'>    ionCount, ionSource, ionSourceDetails, isolationWindowLowerMz,</span>
#&gt; <span class='message'>    isolationWindowUpperMz, msInfo, msLevel, polarity, precScanNum,</span>
#&gt; <span class='message'>    precursorCharge, precursorIntensity, precursorMz, processingData,</span>
#&gt; <span class='message'>    productMz, scanIndex, smooth, smoothed, smoothed&lt;-</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>The following object is masked from 'package:stats':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    smooth</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>The following object is masked from 'package:base':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    trimws</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>This is xcms version 3.6.2 </span>
#&gt; <span class='message'></span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: 'xcms'</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>The following objects are masked from 'package:ProtGenerics':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    peaks&lt;-, polarity&lt;-</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>The following object is masked from 'package:stats':</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    sigma</span></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'><a href='https://rdrr.io/pkg/xcms/man/XCMSnExp-class.html'>chromPeaks</a></span>(<span class='no'>res</span>))</div><div class='output co'>#&gt;             mz mzmin mzmax       rt    rtmin    rtmax      into      intf  maxo
#&gt; CP001 205.0000   205 205.0 2784.635 2770.550 2800.284 1778568.9 3589494.1 84280
#&gt; CP002 205.0000   205 205.0 2784.635 2770.550 2800.284 1778568.9 3589494.1 84280
#&gt; CP003 207.0821   207 207.1 2712.647 2698.562 2726.731  380873.0  725545.6 18800
#&gt; CP004 207.0821   207 207.1 2712.647 2698.562 2726.731  380873.0  725657.0 18800
#&gt; CP005 233.0390   233 233.1 3019.378 3005.293 3033.462  399145.3  746572.1 19752
#&gt; CP006 233.0390   233 233.1 3019.378 3005.293 3033.462  399145.3  746587.0 19752
#&gt;            maxf i       sn sample
#&gt; CP001 194326.10 1 88.11283      1
#&gt; CP002 194326.10 1 87.30418      1
#&gt; CP003  39851.35 1 25.05928      1
#&gt; CP004  39851.56 1 26.10968      1
#&gt; CP005  41455.94 1 28.58299      1
#&gt; CP006  41456.03 1 30.40953      1</div><div class='input'><span class='co'>## The number of peaks identified per sample:</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='fu'><a href='https://rdrr.io/pkg/xcms/man/XCMSnExp-class.html'>chromPeaks</a></span>(<span class='no'>res</span>)[, <span class='st'>"sample"</span>])</div><div class='output co'>#&gt; 
#&gt;   1   2 
#&gt; 251 299 </div><div class='input'>
<span class='co'>## Performing the peak grouping using the "peak density" method.</span>
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/xcms/man/groupChromPeaks-density.html'>PeakDensityParam</a></span>(<span class='kw'>sampleGroups</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>))
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/xcms/man/groupChromPeaks.html'>groupChromPeaks</a></span>(<span class='no'>res</span>, <span class='kw'>param</span> <span class='kw'>=</span> <span class='no'>p</span>)</div><div class='output co'>#&gt; <span class='message'>Processing 3195 mz slices ... </span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='input'>
<span class='co'>## Perform the retention time adjustment using peak groups found in both</span>
<span class='co'>## files.</span>
<span class='no'>fgp</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/xcms/man/adjustRtime-peakGroups.html'>PeakGroupsParam</a></span>(<span class='kw'>minFraction</span> <span class='kw'>=</span> <span class='fl'>1</span>)

<span class='co'>## Before running the alignment we can evaluate which features (peak groups)</span>
<span class='co'>## would be used based on the specified parameters.</span>
<span class='no'>pkGrps</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/xcms/man/adjustRtime-peakGroups.html'>adjustRtimePeakGroups</a></span>(<span class='no'>res</span>, <span class='kw'>param</span> <span class='kw'>=</span> <span class='no'>fgp</span>)

<span class='co'>## We can also plot these to evaluate if the peak groups span a large portion</span>
<span class='co'>## of the retention time range.</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>pkGrps</span>[, <span class='fl'>1</span>], <span class='kw'>y</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>pkGrps</span>)), <span class='kw'>xlim</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span>(<span class='fu'>rtime</span>(<span class='no'>res</span>)),
    <span class='kw'>ylim</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>2</span>), <span class='kw'>xlab</span> <span class='kw'>=</span> <span class='st'>"rt"</span>, <span class='kw'>ylab</span> <span class='kw'>=</span> <span class='st'>""</span>, <span class='kw'>yaxt</span> <span class='kw'>=</span> <span class='st'>"n"</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>pkGrps</span>[, <span class='fl'>2</span>], <span class='kw'>y</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>2</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>pkGrps</span>)))</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/segments.html'>segments</a></span>(<span class='kw'>x0</span> <span class='kw'>=</span> <span class='no'>pkGrps</span>[, <span class='fl'>1</span>], <span class='kw'>x1</span> <span class='kw'>=</span> <span class='no'>pkGrps</span>[, <span class='fl'>2</span>],
    <span class='kw'>y0</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>pkGrps</span>)), <span class='kw'>y1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>2</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>pkGrps</span>)))</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/grid.html'>grid</a></span>()</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/axis.html'>axis</a></span>(<span class='kw'>side</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>at</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>2</span>), <span class='kw'>labels</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>pkGrps</span>))</div><div class='img'><img src='PeakGroupsPar-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Next we perform the alignment.</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/xcms/man/adjustRtime.html'>adjustRtime</a></span>(<span class='no'>res</span>, <span class='kw'>param</span> <span class='kw'>=</span> <span class='no'>fgp</span>)</div><div class='output co'>#&gt; <span class='message'>Performing retention time correction using 39 peak groups.</span></div><div class='output co'>#&gt; <span class='message'>Applying retention time adjustment to the identified chromatographic peaks ... </span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='input'>
<span class='co'>## Any grouping information was dropped</span>
<span class='fu'><a href='https://rdrr.io/pkg/xcms/man/XCMSnExp-class.html'>hasFeatures</a></span>(<span class='no'>res</span>)</div><div class='output co'>#&gt; [1] FALSE</div><div class='input'>
<span class='co'>## Plot the raw against the adjusted retention times.</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='fu'>rtime</span>(<span class='no'>raw_data</span>), <span class='fu'>rtime</span>(<span class='no'>res</span>), <span class='kw'>pch</span> <span class='kw'>=</span> <span class='fl'>16</span>, <span class='kw'>cex</span> <span class='kw'>=</span> <span class='fl'>0.25</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='fu'>fromFile</span>(<span class='no'>res</span>))</div><div class='img'><img src='PeakGroupsPar-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Adjusterd retention times can be accessed using</span>
<span class='co'>## rtime(object, adjusted = TRUE) and adjustedRtime</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span>(<span class='fu'>rtime</span>(<span class='no'>res</span>), <span class='fu'><a href='https://rdrr.io/pkg/xcms/man/XCMSnExp-class.html'>adjustedRtime</a></span>(<span class='no'>res</span>))</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
<span class='co'>## To get the raw, unadjusted retention times:</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span>(<span class='fu'>rtime</span>(<span class='no'>res</span>, <span class='kw'>adjusted</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>), <span class='fu'>rtime</span>(<span class='no'>raw_data</span>))</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
<span class='co'>## To extract the retention times grouped by sample/file:</span>
<span class='no'>rts</span> <span class='kw'>&lt;-</span> <span class='fu'>rtime</span>(<span class='no'>res</span>, <span class='kw'>bySample</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#slots">Slots</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Colin Smith, Johannes Rainer</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Luis Fernandez, Francisco Madrid-Gambin, Sergio Oller, Ivan Montoliu Roura.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


